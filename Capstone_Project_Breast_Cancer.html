<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>c18886d825804c56b98b5c29c45ae4b2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="breast-cancer-risk-prediction" class="cell markdown">
<h1><p style="background-color:maroon; font-family:calibri; color:white; font-size:180%; text-align:center; border-radius:15px 50px;">Breast
Cancer Risk Prediction</p></h1>
</section>
<div class="cell markdown">
<p><img src="Breast_Cancer_image.jpg?raw=true" width="1000"></p>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h3 align="left"><font color=red>Problem:</font></h3>
<p>This project aims to deepen the understanding of breast cancer
survival trends and enhance prediction models for patient outcomes. By
leveraging advanced statistical techniques and machine learning, the
project seeks to analyze survival rates and accurately predict the
10-year mortality risk for breast cancer patients. The ultimate
objective is to improve treatment planning, patient counseling, and
overall cancer care strategies.</p>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h3 align="left"><font color=red>Objectives:</font></h3>
<p><strong>1. Understand Breast Cancer Patient Data</strong>:</p>
<ul>
<li>Collect and explore patient-related attributes, including
demographic, clinical, and survival information.</li>
<li>Identify key patterns and trends that may impact survival
outcomes.</li>
</ul>
<p><strong>2. Perform Data Preprocessing and Feature
Engineering</strong>:</p>
<ul>
<li>Handle missing values using appropriate imputation techniques.</li>
<li>Remove irrelevant features that do not contribute to the predictive
analysis.</li>
<li>Encode categorical variables for compatibility with machine learning
models.</li>
<li>Scale numerical features to ensure balanced model training.</li>
</ul>
<p><strong>3. Build and Evaluate Predictive Models</strong>:</p>
<ul>
<li>Develop machine learning models such as Logistic Regression,
Decision Tree, Random Forest, and Support Vector Machine (SVM) to
classify patient survival outcomes.</li>
<li>Assess model performance using recall, precision, F1-score,
accuracy, and AUC-ROC curves to ensure reliability.</li>
</ul>
<p><strong>4. Conduct Survival Analysis</strong>:</p>
<ul>
<li>Utilize Kaplan-Meier Survival Curves to estimate survival
probabilities over time.</li>
<li>Apply Cox Proportional Hazards Model to determine significant
factors affecting survival.</li>
</ul>
<p><strong>5. Derive Insights for Medical Decision-Making</strong>:</p>
<ul>
<li>Interpret model results to identify factors influencing patient
survival.</li>
<li>Ensure the models prioritize high recall to minimize the risk of
missing critical cases.</li>
<li>Provide data-driven insights that could assist in breast cancer
prognosis and patient care.</li>
</ul>
</div>
<div class="cell markdown">
<p><a id="contents_tabel"></a><br />
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left"></p>
<h3 align="left"><font color=red>Table of Contents:</font></h3>
<ul>
<li><a href="#import">Step 1 | Import Libraries</a></li>
<li><a href="#read">Step 2 | Read Dataset</a></li>
<li><a href="#eda">Step 3 | Exploratory Data Analysis (EDA)</a></li>
<li><a href="#preprocessing">Step 4 | Data Preprocessing</a>
<ul>
<li><a href="#feature_removal">Step 4.1 | Irrelevant Features
Removal</a></li>
<li><a href="#missing">Step 4.2 | Missing Value Treatment</a></li>
<li><a href="#encoding">Step 4.3 | Categorical Features
Encoding</a></li>
<li><a href="#scaling">Step 4.4 | Feature Scaling</a></li>
<li><a href="#correlation">Step 4.5 | Feature Correlation</a></li>
</ul></li>
<li><a href="#splitting">Step 5 | Data Splitting</a></li>
<li><a href="#lr">Step 6 | Logistic Regression Model Building</a>
<ul>
<li><a href="#lr_base">Step 6.1 | LR Base Model Definition</a></li>
<li><a href="#lr_hp">Step 6.2 | LR Hyperparameter Tuning</a></li>
<li><a href="#lr_eval">Step 6.3 | LR Model Evaluation</a></li>
<li><a href="#lr_vis">Step 6.4 | AUC-ROC Curve Visualization</a></li>
</ul></li>
<li><a href="#dt">Step 7 | Decision Tree Model Building</a>
<ul>
<li><a href="#dt_base">Step 7.1 | DT Base Model Definition</a></li>
<li><a href="#dt_hp">Step 7.2 | DT Hyperparameter Tuning</a></li>
<li><a href="#dt_eval">Step 7.3 | DT Model Evaluation</a></li>
<li><a href="#dt_vis">Step 7.4 | DT Model Visualization</a></li>
</ul></li>
<li><a href="#rf">Step 8 | Random Forest Model Building</a>
<ul>
<li><a href="#rf_base">Step 8.1 | RF Model Definition</a></li>
<li><a href="#rf_hp">Step 8.2 | RF Hyperparameter Tuning</a></li>
<li><a href="#rf_eval">Step 8.3 | RF Model Evaluation</a></li>
</ul></li>
<li><a href="#svm">Step 9 | Support Vector Machine (SVM) Model
Building</a>
<ul>
<li><a href="#svm_base">Step 9.1 | SVM Model Definition</a></li>
<li><a href="#svm_hp">Step 9.2 | SVM Hyperparameter Tuning</a></li>
<li><a href="#svm_eval">Step 9.3 | SVM Model Evaluation</a></li>
</ul></li>
<li><a href="#interpretation">Step 10 | Model Interpretation and
Visualization</a>
<ul>
<li><a href="#kmf">Step 10.1 | Kaplan-Meier survival curves</a></li>
<li><a href="#cphm">Step 10.2 | Cox Proportional Hazards Models</a></li>
</ul></li>
<li><a href="#conclusion">Step 11 | Conclusion</a></li>
</ul>
</div>
<div class="cell markdown">
<h2 align="left"><font color=tomato>Let's get started:</font></h2>
</div>
<div class="cell markdown">
<p><a id="import"></a></p>
<h1
id="step-1--import-libraries"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
1 | Import Libraries</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell code" data-execution_count="70">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder, LabelEncoder</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, cross_val_score</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, auc, roc_curve, roc_auc_score</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lifelines <span class="im">import</span> KaplanMeierFitter, CoxPHFitter</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><a id="read"></a></p>
<h1
id="step-2--read-dataset"><p style="background-color:chocolate ; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
2 | Read Dataset</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<h2 align="left"><font color=tomato>Load the Dataset:</font></h2>
</div>
<div class="cell code" data-execution_count="71">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&quot;Breast Cancer METABRIC.csv&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="71">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Patient ID</th>
      <th>Age at Diagnosis</th>
      <th>Type of Breast Surgery</th>
      <th>Cancer Type</th>
      <th>Cancer Type Detailed</th>
      <th>Cellularity</th>
      <th>Chemotherapy</th>
      <th>Pam50 + Claudin-low subtype</th>
      <th>Cohort</th>
      <th>ER status measured by IHC</th>
      <th>...</th>
      <th>Overall Survival Status</th>
      <th>PR Status</th>
      <th>Radio Therapy</th>
      <th>Relapse Free Status (Months)</th>
      <th>Relapse Free Status</th>
      <th>Sex</th>
      <th>3-Gene classifier subtype</th>
      <th>Tumor Size</th>
      <th>Tumor Stage</th>
      <th>Patient's Vital Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>MB-0000</td>
      <td>75.65</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>NaN</td>
      <td>No</td>
      <td>claudin-low</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>Living</td>
      <td>Negative</td>
      <td>Yes</td>
      <td>138.65</td>
      <td>Not Recurred</td>
      <td>Female</td>
      <td>ER-/HER2-</td>
      <td>22.0</td>
      <td>2.0</td>
      <td>Living</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MB-0002</td>
      <td>43.19</td>
      <td>Breast Conserving</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumA</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>Living</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>83.52</td>
      <td>Not Recurred</td>
      <td>Female</td>
      <td>ER+/HER2- High Prolif</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>Living</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MB-0005</td>
      <td>48.87</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>No</td>
      <td>151.28</td>
      <td>Recurred</td>
      <td>Female</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>2.0</td>
      <td>Died of Disease</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MB-0006</td>
      <td>47.68</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Mixed Ductal and Lobular Carcinoma</td>
      <td>Moderate</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>Living</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>162.76</td>
      <td>Not Recurred</td>
      <td>Female</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>2.0</td>
      <td>Living</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MB-0008</td>
      <td>76.97</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Mixed Ductal and Lobular Carcinoma</td>
      <td>High</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>18.55</td>
      <td>Recurred</td>
      <td>Female</td>
      <td>ER+/HER2- High Prolif</td>
      <td>40.0</td>
      <td>2.0</td>
      <td>Died of Disease</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2504</th>
      <td>MTS-T2428</td>
      <td>70.05</td>
      <td>NaN</td>
      <td>Breast Cancer</td>
      <td>Invasive Breast Carcinoma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.93</td>
      <td>Recurred</td>
      <td>Female</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2505</th>
      <td>MTS-T2429</td>
      <td>63.60</td>
      <td>NaN</td>
      <td>Breast Cancer</td>
      <td>Invasive Breast Carcinoma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.18</td>
      <td>Recurred</td>
      <td>Female</td>
      <td>NaN</td>
      <td>28.0</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2506</th>
      <td>MTS-T2430</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Breast Cancer</td>
      <td>Invasive Breast Carcinoma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2507</th>
      <td>MTS-T2431</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Breast Cancer</td>
      <td>Invasive Breast Carcinoma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2508</th>
      <td>MTS-T2432</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Breast Cancer</td>
      <td>Invasive Breast Carcinoma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2509 rows × 34 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Dataset Description:</font></h2>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Variable</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Patient ID</strong></td>
<td style="text-align: left;">Unique identifier for each patient.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Age at Diagnosis</strong></td>
<td style="text-align: left;">Age of the patient when diagnosed with
cancer.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Type of Breast
Surgery</strong></td>
<td style="text-align: left;">The type of surgery performed on the
breast: <br> 0: Mastectomy <br> 1: Lumpectomy</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Cancer Type</strong></td>
<td style="text-align: left;">General classification of the cancer type:
<br> 0: Breast Cancer <br> 1: Breast Sarcoma</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Cancer Type Detailed</strong></td>
<td style="text-align: left;">More specific classification of the cancer
type: <br> 0: Breast Invasive Ductal Carcinoma <br> 1: Breast Mixed
Ductal and Lobular Carcinoma <br> 2: Breast Invasive Lobular Carcinoma
<br> 3: Invasive Breast Carcinoma <br> 4: Breast Invasive Mixed Mucinous
Carcinoma <br> 5: Breast <br> 6: Breast Angiosarcoma <br> 7: Metaplastic
Breast Cancer</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Cellularity</strong></td>
<td style="text-align: left;">The tumor's cellularity degree, is often
used in pathology to describe the proportion of cells versus other
components in a tissue sample: <br> 0: High <br> 1: Moderate <br> 2:
Low</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Chemotherapy</strong></td>
<td style="text-align: left;">Indicates whether the patient received
chemotherapy: <br> 0: No <br> 1: Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Pam50 + Claudin-low
subtype</strong></td>
<td style="text-align: left;">Subtypes based on gene expression
profiling: <br> 0: LumA <br> 1: LumB <br> 2: Her2 <br> 3: claudin-low
<br> 4: Basal <br> 5: Normal <br> 6: NC</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Cohort</strong></td>
<td style="text-align: left;">The group or study cohort to which the
patient belongs.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>ER status measured by
IHC</strong></td>
<td style="text-align: left;">Estrogen receptor status as measured by
Immunohistochemistry (IHC): <br> 0: Positive <br> 1: Negative</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>ER Status</strong></td>
<td style="text-align: left;">Estrogen receptor status: <br> 0: Positive
<br> 1: Negative</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Neoplasm Histologic
Grade</strong></td>
<td style="text-align: left;">Histologic grade of the neoplasm,
indicating how much the tumor cells differ from normal cells.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>HER2 status measured by
SNP6</strong></td>
<td style="text-align: left;">HER2 (human epidermal growth factor
receptor 2) status measured by SNP (single nucleotide polymorphism)
analysis: <br> 0: Neutral <br> 1: Gain <br> 2: Loss <br> 3: Undef</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>HER2 Status</strong></td>
<td style="text-align: left;">HER2 receptor status: <br> 0: Negative
<br> 1: Positive</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Tumor Other Histologic
Subtype</strong></td>
<td style="text-align: left;">Other histologic subtypes of the tumor not
covered by main classifications: <br> 0: Ductal/NST <br> 1: Mixed <br>
2: Lobular <br> 3: Medullary <br> 4: Mucinous <br> 5: Tubular/
cribriform <br> 6: Other <br> 7: Metaplastic</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Hormone Therapy</strong></td>
<td style="text-align: left;">Indicates whether the patient received
hormone therapy: <br> 0: Yes <br> 1: No</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Inferred Menopausal
State</strong></td>
<td style="text-align: left;">Menopausal state inferred based on age and
clinical criteria: <br> 0: Post <br> 1: Pre</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Integrative Cluster</strong></td>
<td style="text-align: left;">Classification based on integrative
clustering of genomic data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Primary Tumor
Laterality</strong></td>
<td style="text-align: left;">The side of the body where the primary
tumor is located: <br> 0: Left <br> 1: Right</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lymph nodes examined
positive</strong></td>
<td style="text-align: left;">Number of lymph nodes that tested positive
for cancer.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Mutation Count</strong></td>
<td style="text-align: left;">Total number of genetic mutations
identified in the tumor.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Nottingham prognostic
index</strong></td>
<td style="text-align: left;">Prognostic score based on tumor size,
lymph node status, and histologic grade.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Oncotree Code</strong></td>
<td style="text-align: left;">A code that represents the type of cancer
based on the OncoTree classification: <br> 0: IDC <br> 1: MDLC <br> 2:
ILC <br> 3: BRCA <br> 4: IMMC <br> 5: BREAST <br> 6: PBS <br> 7:
MBC</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Overall Survival
(Months)</strong></td>
<td style="text-align: left;">The overall survival time of the patient
in months.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Overall Survival
Status</strong></td>
<td style="text-align: left;">Indicates whether the patient is alive or
deceased: <br> 0: Deceased <br> 1: Living</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>PR Status</strong></td>
<td style="text-align: left;">Progesterone receptor status: <br> 0:
Positive <br> 1: Negative</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Radio Therapy</strong></td>
<td style="text-align: left;">Indicates whether the patient received
radiotherapy: <br> 0: Yes <br> 1: No</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Relapse Free Status
(Months)</strong></td>
<td style="text-align: left;">Time in months the patient remained free
from cancer relapse.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Relapse Free Status</strong></td>
<td style="text-align: left;">Indicates whether the patient has had a
cancer relapse: <br> 0: Not Recurred <br> 1: Recurred</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Sex</strong></td>
<td style="text-align: left;">The sex of the patient: Female</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>3-Gene classifier
subtype</strong></td>
<td style="text-align: left;">Subtypes based on the expression of three
specific genes: <br> 0: ER+/HER2- Low Prolif <br> 1: ER+/HER2- High
Prolif <br> 2: ER-/HER2- <br> 3: HER2+</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Tumor Size</strong></td>
<td style="text-align: left;">Size of the primary tumor.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Tumor Stage</strong></td>
<td style="text-align: left;">Stage of the tumor, indicating the extent
of cancer spread.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Patient's Vital
Status</strong></td>
<td style="text-align: left;">Indicates whether the patient is alive or
deceased at the last follow-up: <br> 0: Living <br> 1: Died of Disease
<br> 2: Died of Other Causes</td>
</tr>
</tbody>
</table>
</div>
<div class="cell markdown">
<p><a id="eda"></a></p>
<h1
id="step-3--exploratory-data-analysis-eda"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
3 | Exploratory Data Analysis (EDA)</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell code" data-execution_count="72">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the Numerical Data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.describe().T</span></code></pre></div>
<div class="output execute_result" data-execution_count="72">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age at Diagnosis</th>
      <td>2498.0</td>
      <td>60.420300</td>
      <td>13.032997</td>
      <td>21.93</td>
      <td>50.920000</td>
      <td>61.110000</td>
      <td>70.000000</td>
      <td>96.29</td>
    </tr>
    <tr>
      <th>Cohort</th>
      <td>2498.0</td>
      <td>2.900320</td>
      <td>1.962216</td>
      <td>1.00</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>9.00</td>
    </tr>
    <tr>
      <th>Neoplasm Histologic Grade</th>
      <td>2388.0</td>
      <td>2.412060</td>
      <td>0.649363</td>
      <td>1.00</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>Lymph nodes examined positive</th>
      <td>2243.0</td>
      <td>1.950513</td>
      <td>4.017774</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>45.00</td>
    </tr>
    <tr>
      <th>Mutation Count</th>
      <td>2357.0</td>
      <td>5.578702</td>
      <td>3.967967</td>
      <td>1.00</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>7.000000</td>
      <td>80.00</td>
    </tr>
    <tr>
      <th>Nottingham prognostic index</th>
      <td>2287.0</td>
      <td>4.028787</td>
      <td>1.189092</td>
      <td>1.00</td>
      <td>3.048000</td>
      <td>4.044000</td>
      <td>5.040000</td>
      <td>7.20</td>
    </tr>
    <tr>
      <th>Overall Survival (Months)</th>
      <td>1981.0</td>
      <td>125.244271</td>
      <td>76.111772</td>
      <td>0.00</td>
      <td>60.866667</td>
      <td>116.466667</td>
      <td>185.133333</td>
      <td>355.20</td>
    </tr>
    <tr>
      <th>Relapse Free Status (Months)</th>
      <td>2388.0</td>
      <td>108.842487</td>
      <td>76.519494</td>
      <td>0.00</td>
      <td>40.560000</td>
      <td>99.095000</td>
      <td>167.640000</td>
      <td>384.21</td>
    </tr>
    <tr>
      <th>Tumor Size</th>
      <td>2360.0</td>
      <td>26.220093</td>
      <td>15.370883</td>
      <td>1.00</td>
      <td>17.000000</td>
      <td>22.410000</td>
      <td>30.000000</td>
      <td>182.00</td>
    </tr>
    <tr>
      <th>Tumor Stage</th>
      <td>1788.0</td>
      <td>1.713647</td>
      <td>0.655307</td>
      <td>0.00</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>4.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="73">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the Categorical Data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="st">&#39;object&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="73">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Patient ID</th>
      <th>Type of Breast Surgery</th>
      <th>Cancer Type</th>
      <th>Cancer Type Detailed</th>
      <th>Cellularity</th>
      <th>Chemotherapy</th>
      <th>Pam50 + Claudin-low subtype</th>
      <th>ER status measured by IHC</th>
      <th>ER Status</th>
      <th>HER2 status measured by SNP6</th>
      <th>...</th>
      <th>Integrative Cluster</th>
      <th>Primary Tumor Laterality</th>
      <th>Oncotree Code</th>
      <th>Overall Survival Status</th>
      <th>PR Status</th>
      <th>Radio Therapy</th>
      <th>Relapse Free Status</th>
      <th>Sex</th>
      <th>3-Gene classifier subtype</th>
      <th>Patient's Vital Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2509</td>
      <td>1955</td>
      <td>2509</td>
      <td>2509</td>
      <td>1917</td>
      <td>1980</td>
      <td>1980</td>
      <td>2426</td>
      <td>2469</td>
      <td>1980</td>
      <td>...</td>
      <td>1980</td>
      <td>1870</td>
      <td>2509</td>
      <td>1981</td>
      <td>1980</td>
      <td>1980</td>
      <td>2488</td>
      <td>2509</td>
      <td>1764</td>
      <td>1980</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2509</td>
      <td>2</td>
      <td>2</td>
      <td>8</td>
      <td>3</td>
      <td>2</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>...</td>
      <td>11</td>
      <td>2</td>
      <td>8</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>MTS-T2432</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumA</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>Neutral</td>
      <td>...</td>
      <td>8</td>
      <td>Left</td>
      <td>IDC</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>Not Recurred</td>
      <td>Female</td>
      <td>ER+/HER2- Low Prolif</td>
      <td>Living</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>1170</td>
      <td>2506</td>
      <td>1865</td>
      <td>965</td>
      <td>1568</td>
      <td>700</td>
      <td>1817</td>
      <td>1825</td>
      <td>1436</td>
      <td>...</td>
      <td>299</td>
      <td>973</td>
      <td>1865</td>
      <td>1144</td>
      <td>1040</td>
      <td>1173</td>
      <td>1486</td>
      <td>2509</td>
      <td>640</td>
      <td>837</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 24 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="74">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datatypes of the Features</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>Patient ID                         object
Age at Diagnosis                  float64
Type of Breast Surgery             object
Cancer Type                        object
Cancer Type Detailed               object
Cellularity                        object
Chemotherapy                       object
Pam50 + Claudin-low subtype        object
Cohort                            float64
ER status measured by IHC          object
ER Status                          object
Neoplasm Histologic Grade         float64
HER2 status measured by SNP6       object
HER2 Status                        object
Tumor Other Histologic Subtype     object
Hormone Therapy                    object
Inferred Menopausal State          object
Integrative Cluster                object
Primary Tumor Laterality           object
Lymph nodes examined positive     float64
Mutation Count                    float64
Nottingham prognostic index       float64
Oncotree Code                      object
Overall Survival (Months)         float64
Overall Survival Status            object
PR Status                          object
Radio Therapy                      object
Relapse Free Status (Months)      float64
Relapse Free Status                object
Sex                                object
3-Gene classifier subtype          object
Tumor Size                        float64
Tumor Stage                       float64
Patient&#39;s Vital Status             object
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Information about the Dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2509 entries, 0 to 2508
Data columns (total 34 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   Patient ID                      2509 non-null   object 
 1   Age at Diagnosis                2498 non-null   float64
 2   Type of Breast Surgery          1955 non-null   object 
 3   Cancer Type                     2509 non-null   object 
 4   Cancer Type Detailed            2509 non-null   object 
 5   Cellularity                     1917 non-null   object 
 6   Chemotherapy                    1980 non-null   object 
 7   Pam50 + Claudin-low subtype     1980 non-null   object 
 8   Cohort                          2498 non-null   float64
 9   ER status measured by IHC       2426 non-null   object 
 10  ER Status                       2469 non-null   object 
 11  Neoplasm Histologic Grade       2388 non-null   float64
 12  HER2 status measured by SNP6    1980 non-null   object 
 13  HER2 Status                     1980 non-null   object 
 14  Tumor Other Histologic Subtype  2374 non-null   object 
 15  Hormone Therapy                 1980 non-null   object 
 16  Inferred Menopausal State       1980 non-null   object 
 17  Integrative Cluster             1980 non-null   object 
 18  Primary Tumor Laterality        1870 non-null   object 
 19  Lymph nodes examined positive   2243 non-null   float64
 20  Mutation Count                  2357 non-null   float64
 21  Nottingham prognostic index     2287 non-null   float64
 22  Oncotree Code                   2509 non-null   object 
 23  Overall Survival (Months)       1981 non-null   float64
 24  Overall Survival Status         1981 non-null   object 
 25  PR Status                       1980 non-null   object 
 26  Radio Therapy                   1980 non-null   object 
 27  Relapse Free Status (Months)    2388 non-null   float64
 28  Relapse Free Status             2488 non-null   object 
 29  Sex                             2509 non-null   object 
 30  3-Gene classifier subtype       1764 non-null   object 
 31  Tumor Size                      2360 non-null   float64
 32  Tumor Stage                     1788 non-null   float64
 33  Patient&#39;s Vital Status          1980 non-null   object 
dtypes: float64(10), object(24)
memory usage: 666.6+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for Missing Values</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="76">
<pre><code>Patient ID                          0
Age at Diagnosis                   11
Type of Breast Surgery            554
Cancer Type                         0
Cancer Type Detailed                0
Cellularity                       592
Chemotherapy                      529
Pam50 + Claudin-low subtype       529
Cohort                             11
ER status measured by IHC          83
ER Status                          40
Neoplasm Histologic Grade         121
HER2 status measured by SNP6      529
HER2 Status                       529
Tumor Other Histologic Subtype    135
Hormone Therapy                   529
Inferred Menopausal State         529
Integrative Cluster               529
Primary Tumor Laterality          639
Lymph nodes examined positive     266
Mutation Count                    152
Nottingham prognostic index       222
Oncotree Code                       0
Overall Survival (Months)         528
Overall Survival Status           528
PR Status                         529
Radio Therapy                     529
Relapse Free Status (Months)      121
Relapse Free Status                21
Sex                                 0
3-Gene classifier subtype         745
Tumor Size                        149
Tumor Stage                       721
Patient&#39;s Vital Status            529
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="77">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Value Counts of the Target Variable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;Overall Survival Status&quot;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="77">
<pre><code>Overall Survival Status
Deceased    1144
Living       837
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<ul>
<li><p><strong>Number of Entries</strong>: The dataset contains
<strong>2,509 records</strong>, indexed from 0 to 2,508.</p></li>
<li><p><strong>Columns</strong>: There are <strong>34 features</strong>
in the dataset, representing various patient attributes and test
results.</p></li>
<li><p><strong>Data Types</strong>:</p>
<ul>
<li>The majority of the columns <strong>(24 out of 34)</strong> are of
<strong>float64</strong> type.</li>
<li>The remaining <strong>10 columns</strong> are of
<strong>object</strong> type.</li>
</ul></li>
<li><p><strong>Missing Values</strong>: The dataset has a few missing
values, with each column having a high number of non-null
entries.</p></li>
</ul>
</div>
<div class="cell code" data-execution_count="78">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Age Distribution of Patients</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">&quot;Age at Diagnosis&quot;</span>].dropna(), bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&quot;teal&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Distribution of Age at Diagnosis&quot;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Age&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/9b07369a702ff392d028e39ade8a6652c4933854.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="79">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Survival Status vs. Age at Diagnosis</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&quot;Overall Survival Status&quot;</span>, y<span class="op">=</span><span class="st">&quot;Age at Diagnosis&quot;</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">&quot;coolwarm&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Age Distribution by Survival Status&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Survival Status (0: Deceased, 1: Living)&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Age at Diagnosis&quot;</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/47c84c44ca1cffb4b447840f7a625ff49e5e48e3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="80">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Survival Status by Tumor Stage</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&quot;Tumor Stage&quot;</span>, hue<span class="op">=</span><span class="st">&quot;Overall Survival Status&quot;</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">&quot;coolwarm&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Survival Status by Tumor Stage&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Tumor Stage&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&quot;Survival Status&quot;</span>, labels<span class="op">=</span>[<span class="st">&quot;Deceased (0)&quot;</span>, <span class="st">&quot;Living (1)&quot;</span>])</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/70c174c819b494820b2404cd4de8c62cd26e7057.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Explanations of Key Visualizations:</font></h2>
<p><strong>1. Age Distribution of Patients</strong></p>
<p>This visualization shows the distribution of patients' ages at the
time of breast cancer diagnosis. It helps identify the most common age
groups affected by the disease and whether the age distribution follows
a specific pattern. The presence of a density curve makes it easier to
observe trends, such as whether diagnoses peak at certain ages.</p>
<p><strong>2. Survival Status vs. Age at Diagnosis</strong></p>
<p>The boxplot compares the age distribution of patients who survived
versus those who didn’t. It highlights differences in median age and the
spread of age values within each group. Outliers indicate patients whose
ages significantly differ from the majority. This plot helps analyze
whether age is a crucial factor in survival.</p>
<p><strong>3. Survival Status by Tumor Stage</strong></p>
<p>This visualization illustrates how survival outcomes vary across
different tumor stages. By comparing the number of deceased and living
patients in each stage, it provides insights into whether higher tumor
stages correspond to lower survival rates. It helps in assessing the
impact of disease progression on patient outcomes.</p>
</div>
<div class="cell markdown">
<p><a id="preprocessing"></a></p>
<h1
id="step-4--data-preprocessing"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
4 | Data Preprocessing</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<p><a id="feature_removal"></a></p>
<h1
id="step-41--irrelevant-features-removal"><b><span style='color:coral'>Step
4.1 |</span><span style='color:tomato'> Irrelevant Features
Removal</span></b></h1>
</div>
<div class="cell code" data-execution_count="81">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the irrelevant Features</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span> [<span class="st">&quot;Patient ID&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Patient&#39;s Vital Status&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><a id="missing"></a></p>
<h1
id="step-42--missing-value-treatment"><b><span style='color:coral'>Step
4.2 |</span><span style='color:tomato'> Missing Value
Treatment</span></b></h1>
</div>
<div class="cell code" data-execution_count="82">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the Rows with Missing Values in the Target Variable</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">&quot;Overall Survival Status&quot;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="82">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age at Diagnosis</th>
      <th>Type of Breast Surgery</th>
      <th>Cancer Type</th>
      <th>Cancer Type Detailed</th>
      <th>Cellularity</th>
      <th>Chemotherapy</th>
      <th>Pam50 + Claudin-low subtype</th>
      <th>Cohort</th>
      <th>ER status measured by IHC</th>
      <th>ER Status</th>
      <th>...</th>
      <th>Oncotree Code</th>
      <th>Overall Survival (Months)</th>
      <th>Overall Survival Status</th>
      <th>PR Status</th>
      <th>Radio Therapy</th>
      <th>Relapse Free Status (Months)</th>
      <th>Relapse Free Status</th>
      <th>3-Gene classifier subtype</th>
      <th>Tumor Size</th>
      <th>Tumor Stage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75.65</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>NaN</td>
      <td>No</td>
      <td>claudin-low</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>140.500000</td>
      <td>Living</td>
      <td>Negative</td>
      <td>Yes</td>
      <td>138.65</td>
      <td>Not Recurred</td>
      <td>ER-/HER2-</td>
      <td>22.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>43.19</td>
      <td>Breast Conserving</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumA</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>84.633333</td>
      <td>Living</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>83.52</td>
      <td>Not Recurred</td>
      <td>ER+/HER2- High Prolif</td>
      <td>10.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48.87</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>163.700000</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>No</td>
      <td>151.28</td>
      <td>Recurred</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.68</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Mixed Ductal and Lobular Carcinoma</td>
      <td>Moderate</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>MDLC</td>
      <td>164.933333</td>
      <td>Living</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>162.76</td>
      <td>Not Recurred</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76.97</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Mixed Ductal and Lobular Carcinoma</td>
      <td>High</td>
      <td>Yes</td>
      <td>LumB</td>
      <td>1.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>MDLC</td>
      <td>41.366667</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>18.55</td>
      <td>Recurred</td>
      <td>ER+/HER2- High Prolif</td>
      <td>40.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1976</th>
      <td>43.10</td>
      <td>Breast Conserving</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Lobular Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumA</td>
      <td>4.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>ILC</td>
      <td>196.866667</td>
      <td>Living</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>194.28</td>
      <td>Not Recurred</td>
      <td>ER+/HER2- Low Prolif</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>42.88</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumB</td>
      <td>4.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>44.733333</td>
      <td>Deceased</td>
      <td>Negative</td>
      <td>Yes</td>
      <td>16.09</td>
      <td>Recurred</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1978</th>
      <td>62.90</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumB</td>
      <td>4.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>175.966667</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>Yes</td>
      <td>121.18</td>
      <td>Recurred</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1979</th>
      <td>61.16</td>
      <td>Mastectomy</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>Moderate</td>
      <td>No</td>
      <td>LumB</td>
      <td>4.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>86.233333</td>
      <td>Deceased</td>
      <td>Positive</td>
      <td>No</td>
      <td>85.10</td>
      <td>Not Recurred</td>
      <td>ER+/HER2- High Prolif</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>60.02</td>
      <td>Breast Conserving</td>
      <td>Breast Cancer</td>
      <td>Breast Invasive Ductal Carcinoma</td>
      <td>High</td>
      <td>No</td>
      <td>LumB</td>
      <td>4.0</td>
      <td>Positve</td>
      <td>Positive</td>
      <td>...</td>
      <td>IDC</td>
      <td>201.900000</td>
      <td>Deceased</td>
      <td>Negative</td>
      <td>Yes</td>
      <td>199.24</td>
      <td>Not Recurred</td>
      <td>ER+/HER2- High Prolif</td>
      <td>20.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1981 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="83">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill the Missing Values in the Categorical Features with the Mean and Mode</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;Age at Diagnosis&quot;</span>].fillna(df[<span class="st">&quot;Age at Diagnosis&quot;</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;Cohort&quot;</span>].fillna(df[<span class="st">&quot;Cohort&quot;</span>].mode()[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<p>Some columns in the dataset do not contribute to the analysis or
prediction and should be removed:</p>
<ul>
<li><p><strong>Patient ID</strong>: This is a unique identifier for each
patient and does not provide any meaningful information for analysis or
modeling. It should be dropped to avoid unnecessary complexity.</p></li>
<li><p><strong>Sex</strong>: The dataset contains only female patients
(as breast cancer is more common in women), this column does not add any
useful information. If there is no variation in this feature, it can be
removed.</p></li>
<li><p><strong>Patient's Vital Status</strong>: This column was removed
as it provided similar results to the target variable "Overall Survival
Status," making it redundant.</p></li>
</ul>
<p>Rows with missing values in <strong>"Overall Survival
Status"</strong> were removed to maintain data quality and ensure
accurate analysis. This prevents errors in modeling and improves
reliability.</p>
<p>Columns with few missing values, such as <strong>"Age at
Diagnosis"</strong> and <strong>"Cohort"</strong>, were filled using
appropriate imputation methods like mean and mode</p>
</div>
<div class="cell markdown">
<p><a id="encoding"></a></p>
<h1
id="step-43--categorical-features-encoding"><b><span style='color:coral'>Step
4.3 |</span><span style='color:tomato'> Categorical Features
Encoding</span></b></h1>
</div>
<div class="cell code" data-execution_count="84">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Categorical Features to Numerical Features using Label Encoding</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cat_columns <span class="op">=</span> df.columns[df.dtypes <span class="op">==</span> <span class="st">&#39;object&#39;</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cat <span class="kw">in</span> cat_columns:</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    df[cat] <span class="op">=</span> le.fit_transform(df[cat])</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="84">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age at Diagnosis</th>
      <th>Type of Breast Surgery</th>
      <th>Cancer Type</th>
      <th>Cancer Type Detailed</th>
      <th>Cellularity</th>
      <th>Chemotherapy</th>
      <th>Pam50 + Claudin-low subtype</th>
      <th>Cohort</th>
      <th>ER status measured by IHC</th>
      <th>ER Status</th>
      <th>...</th>
      <th>Oncotree Code</th>
      <th>Overall Survival (Months)</th>
      <th>Overall Survival Status</th>
      <th>PR Status</th>
      <th>Radio Therapy</th>
      <th>Relapse Free Status (Months)</th>
      <th>Relapse Free Status</th>
      <th>3-Gene classifier subtype</th>
      <th>Tumor Size</th>
      <th>Tumor Stage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75.65</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>140.500000</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>138.65</td>
      <td>0</td>
      <td>2</td>
      <td>22.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>43.19</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>84.633333</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>83.52</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48.87</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>163.700000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>151.28</td>
      <td>1</td>
      <td>4</td>
      <td>15.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.68</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>164.933333</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>162.76</td>
      <td>0</td>
      <td>4</td>
      <td>25.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76.97</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>6</td>
      <td>41.366667</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>18.55</td>
      <td>1</td>
      <td>0</td>
      <td>40.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1976</th>
      <td>43.10</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>196.866667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>194.28</td>
      <td>0</td>
      <td>1</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>42.88</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>44.733333</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>16.09</td>
      <td>1</td>
      <td>4</td>
      <td>20.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1978</th>
      <td>62.90</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>175.966667</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>121.18</td>
      <td>1</td>
      <td>4</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1979</th>
      <td>61.16</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>86.233333</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>85.10</td>
      <td>0</td>
      <td>0</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>60.02</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>201.900000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>199.24</td>
      <td>0</td>
      <td>0</td>
      <td>20.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1981 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="85">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datatypes of the Features after Label Encoding</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="85">
<pre><code>Age at Diagnosis                  float64
Type of Breast Surgery              int64
Cancer Type                         int64
Cancer Type Detailed                int64
Cellularity                         int64
Chemotherapy                        int64
Pam50 + Claudin-low subtype         int64
Cohort                            float64
ER status measured by IHC           int64
ER Status                           int64
Neoplasm Histologic Grade         float64
HER2 status measured by SNP6        int64
HER2 Status                         int64
Tumor Other Histologic Subtype      int64
Hormone Therapy                     int64
Inferred Menopausal State           int64
Integrative Cluster                 int64
Primary Tumor Laterality            int64
Lymph nodes examined positive     float64
Mutation Count                    float64
Nottingham prognostic index       float64
Oncotree Code                       int64
Overall Survival (Months)         float64
Overall Survival Status             int64
PR Status                           int64
Radio Therapy                       int64
Relapse Free Status (Months)      float64
Relapse Free Status                 int64
3-Gene classifier subtype           int64
Tumor Size                        float64
Tumor Stage                       float64
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<p>All categorical features were converted into numerical format using
<strong>Label Encoding</strong>. This assigns a unique numerical value
to each category, making the data suitable for machine learning models
while preserving its structure.</p>
</div>
<div class="cell markdown">
<p><a id="scaling"></a></p>
<h1 id="step-44--feature-scaling"><b><span style='color:coral'>Step 4.4
|</span><span style='color:tomato'> Feature Scaling</span></b></h1>
</div>
<div class="cell code" data-execution_count="86">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale features (critical for KNN distance calculations)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="op">=</span> scaler.fit_transform(df)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="87">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize KNN Imputer (adjust n_neighbors based on data size)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>, weights<span class="op">=</span><span class="st">&#39;distance&#39;</span>)  <span class="co"># Use 3-10 neighbors</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df_imputed <span class="op">=</span> imputer.fit_transform(df_scaled)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to DataFrame and reverse scaling</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>df_imputed <span class="op">=</span> pd.DataFrame(scaler.inverse_transform(df_imputed), columns<span class="op">=</span>df.columns)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_imputed</span></code></pre></div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<ul>
<li><p><strong>Feature Scaling</strong>: Numerical features were scaled
to ensure uniformity and improve model performance. This helps prevent
dominance by features with larger ranges.</p></li>
<li><p><strong>Missing Value Imputation</strong>: Columns with a large
number of missing values were filled using the <strong>KNN
Imputer</strong>, which predicts missing values based on the nearest
neighbors, preserving data patterns and relationships.</p></li>
</ul>
</div>
<div class="cell markdown">
<p><a id="correlation"></a></p>
<h1 id="step-45--feature-correlation"><b><span style='color:coral'>Step
4.5 |</span><span style='color:tomato'> Feature
Correlation</span></b></h1>
</div>
<div class="cell code" data-execution_count="88">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Correlation between the Features</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="88">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age at Diagnosis</th>
      <th>Type of Breast Surgery</th>
      <th>Cancer Type</th>
      <th>Cancer Type Detailed</th>
      <th>Cellularity</th>
      <th>Chemotherapy</th>
      <th>Pam50 + Claudin-low subtype</th>
      <th>Cohort</th>
      <th>ER status measured by IHC</th>
      <th>ER Status</th>
      <th>...</th>
      <th>Oncotree Code</th>
      <th>Overall Survival (Months)</th>
      <th>Overall Survival Status</th>
      <th>PR Status</th>
      <th>Radio Therapy</th>
      <th>Relapse Free Status (Months)</th>
      <th>Relapse Free Status</th>
      <th>3-Gene classifier subtype</th>
      <th>Tumor Size</th>
      <th>Tumor Stage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age at Diagnosis</th>
      <td>1.000000</td>
      <td>0.105140</td>
      <td>-0.020145</td>
      <td>0.052993</td>
      <td>-0.003783</td>
      <td>-0.415765</td>
      <td>0.001554</td>
      <td>0.058856</td>
      <td>0.293441</td>
      <td>0.278942</td>
      <td>...</td>
      <td>0.062206</td>
      <td>-0.145803</td>
      <td>-0.303115</td>
      <td>0.085297</td>
      <td>-0.127463</td>
      <td>-0.084559</td>
      <td>-0.064534</td>
      <td>-0.165661</td>
      <td>0.045978</td>
      <td>0.080849</td>
    </tr>
    <tr>
      <th>Type of Breast Surgery</th>
      <td>0.105140</td>
      <td>1.000000</td>
      <td>0.029118</td>
      <td>0.017245</td>
      <td>0.044335</td>
      <td>0.064300</td>
      <td>-0.017545</td>
      <td>0.008885</td>
      <td>0.002789</td>
      <td>-0.010640</td>
      <td>...</td>
      <td>-0.004981</td>
      <td>-0.112348</td>
      <td>-0.174123</td>
      <td>-0.036952</td>
      <td>-0.485885</td>
      <td>-0.109563</td>
      <td>0.088921</td>
      <td>0.007630</td>
      <td>0.241533</td>
      <td>0.219802</td>
    </tr>
    <tr>
      <th>Cancer Type</th>
      <td>-0.020145</td>
      <td>0.029118</td>
      <td>1.000000</td>
      <td>-0.040383</td>
      <td>0.028129</td>
      <td>-0.019957</td>
      <td>0.078201</td>
      <td>-0.051188</td>
      <td>0.103626</td>
      <td>-0.039013</td>
      <td>...</td>
      <td>0.084689</td>
      <td>-0.027626</td>
      <td>0.045530</td>
      <td>-0.040942</td>
      <td>-0.046924</td>
      <td>-0.020290</td>
      <td>-0.032154</td>
      <td>0.038482</td>
      <td>-0.013406</td>
      <td>-0.074396</td>
    </tr>
    <tr>
      <th>Cancer Type Detailed</th>
      <td>0.052993</td>
      <td>0.017245</td>
      <td>-0.040383</td>
      <td>1.000000</td>
      <td>0.084827</td>
      <td>-0.115688</td>
      <td>0.063988</td>
      <td>-0.039345</td>
      <td>0.161129</td>
      <td>0.094956</td>
      <td>...</td>
      <td>0.699128</td>
      <td>0.036518</td>
      <td>-0.014288</td>
      <td>0.084579</td>
      <td>-0.053921</td>
      <td>0.030933</td>
      <td>-0.018373</td>
      <td>-0.069153</td>
      <td>0.008142</td>
      <td>-0.101022</td>
    </tr>
    <tr>
      <th>Cellularity</th>
      <td>-0.003783</td>
      <td>0.044335</td>
      <td>0.028129</td>
      <td>0.084827</td>
      <td>1.000000</td>
      <td>-0.063705</td>
      <td>0.148688</td>
      <td>-0.102776</td>
      <td>0.092460</td>
      <td>0.044178</td>
      <td>...</td>
      <td>0.075948</td>
      <td>0.037511</td>
      <td>0.008493</td>
      <td>0.028045</td>
      <td>-0.036856</td>
      <td>0.017248</td>
      <td>0.004789</td>
      <td>0.038176</td>
      <td>-0.073892</td>
      <td>-0.068778</td>
    </tr>
    <tr>
      <th>Chemotherapy</th>
      <td>-0.415765</td>
      <td>0.064300</td>
      <td>-0.019957</td>
      <td>-0.115688</td>
      <td>-0.063705</td>
      <td>1.000000</td>
      <td>-0.075536</td>
      <td>-0.133042</td>
      <td>-0.513951</td>
      <td>-0.449519</td>
      <td>...</td>
      <td>-0.112020</td>
      <td>-0.162947</td>
      <td>0.035280</td>
      <td>-0.256699</td>
      <td>0.234951</td>
      <td>-0.143892</td>
      <td>0.135218</td>
      <td>0.226495</td>
      <td>0.198218</td>
      <td>0.334580</td>
    </tr>
    <tr>
      <th>Pam50 + Claudin-low subtype</th>
      <td>0.001554</td>
      <td>-0.017545</td>
      <td>0.078201</td>
      <td>0.063988</td>
      <td>0.148688</td>
      <td>-0.075536</td>
      <td>1.000000</td>
      <td>-0.145956</td>
      <td>0.163463</td>
      <td>0.102372</td>
      <td>...</td>
      <td>0.044668</td>
      <td>0.026282</td>
      <td>0.070589</td>
      <td>0.028320</td>
      <td>0.004469</td>
      <td>0.035655</td>
      <td>-0.045770</td>
      <td>-0.068081</td>
      <td>-0.046597</td>
      <td>-0.052015</td>
    </tr>
    <tr>
      <th>Cohort</th>
      <td>0.058856</td>
      <td>0.008885</td>
      <td>-0.051188</td>
      <td>-0.039345</td>
      <td>-0.102776</td>
      <td>-0.133042</td>
      <td>-0.145956</td>
      <td>1.000000</td>
      <td>-0.075162</td>
      <td>-0.004237</td>
      <td>...</td>
      <td>-0.011877</td>
      <td>0.090927</td>
      <td>-0.154633</td>
      <td>0.018509</td>
      <td>-0.203728</td>
      <td>0.074819</td>
      <td>0.010319</td>
      <td>-0.016501</td>
      <td>0.015202</td>
      <td>-0.014845</td>
    </tr>
    <tr>
      <th>ER status measured by IHC</th>
      <td>0.293441</td>
      <td>0.002789</td>
      <td>0.103626</td>
      <td>0.161129</td>
      <td>0.092460</td>
      <td>-0.513951</td>
      <td>0.163463</td>
      <td>-0.075162</td>
      <td>1.000000</td>
      <td>0.714323</td>
      <td>...</td>
      <td>0.122943</td>
      <td>0.095315</td>
      <td>-0.001551</td>
      <td>0.398906</td>
      <td>-0.125338</td>
      <td>0.062689</td>
      <td>-0.061594</td>
      <td>-0.351662</td>
      <td>-0.097906</td>
      <td>-0.165972</td>
    </tr>
    <tr>
      <th>ER Status</th>
      <td>0.278942</td>
      <td>-0.010640</td>
      <td>-0.039013</td>
      <td>0.094956</td>
      <td>0.044178</td>
      <td>-0.449519</td>
      <td>0.102372</td>
      <td>-0.004237</td>
      <td>0.714323</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0.161909</td>
      <td>0.124821</td>
      <td>-0.028093</td>
      <td>0.542302</td>
      <td>-0.083772</td>
      <td>0.083115</td>
      <td>-0.036986</td>
      <td>-0.471022</td>
      <td>-0.075291</td>
      <td>-0.089640</td>
    </tr>
    <tr>
      <th>Neoplasm Histologic Grade</th>
      <td>-0.126671</td>
      <td>0.046895</td>
      <td>-0.051608</td>
      <td>-0.183756</td>
      <td>-0.089651</td>
      <td>0.298443</td>
      <td>-0.074217</td>
      <td>-0.039208</td>
      <td>-0.375197</td>
      <td>-0.359693</td>
      <td>...</td>
      <td>-0.145886</td>
      <td>-0.126802</td>
      <td>-0.082090</td>
      <td>-0.304545</td>
      <td>0.158346</td>
      <td>-0.110009</td>
      <td>0.133738</td>
      <td>0.146530</td>
      <td>0.130353</td>
      <td>0.201891</td>
    </tr>
    <tr>
      <th>HER2 status measured by SNP6</th>
      <td>0.086662</td>
      <td>-0.061978</td>
      <td>0.022789</td>
      <td>0.089647</td>
      <td>0.013996</td>
      <td>-0.133553</td>
      <td>0.106860</td>
      <td>-0.010379</td>
      <td>0.149964</td>
      <td>0.186515</td>
      <td>...</td>
      <td>0.126282</td>
      <td>0.129837</td>
      <td>0.032778</td>
      <td>0.185946</td>
      <td>-0.005710</td>
      <td>0.120245</td>
      <td>-0.079464</td>
      <td>-0.230470</td>
      <td>-0.034053</td>
      <td>-0.041210</td>
    </tr>
    <tr>
      <th>HER2 Status</th>
      <td>-0.121989</td>
      <td>0.066265</td>
      <td>-0.014699</td>
      <td>-0.064714</td>
      <td>0.003923</td>
      <td>0.204285</td>
      <td>-0.137009</td>
      <td>0.021867</td>
      <td>-0.225969</td>
      <td>-0.282172</td>
      <td>...</td>
      <td>-0.113833</td>
      <td>-0.119530</td>
      <td>-0.040525</td>
      <td>-0.227137</td>
      <td>0.019428</td>
      <td>-0.103798</td>
      <td>0.085667</td>
      <td>0.377580</td>
      <td>0.036509</td>
      <td>0.079045</td>
    </tr>
    <tr>
      <th>Tumor Other Histologic Subtype</th>
      <td>0.028082</td>
      <td>-0.003073</td>
      <td>0.091385</td>
      <td>0.766359</td>
      <td>0.061194</td>
      <td>-0.117799</td>
      <td>0.082983</td>
      <td>-0.051568</td>
      <td>0.156181</td>
      <td>0.070973</td>
      <td>...</td>
      <td>0.453053</td>
      <td>0.072988</td>
      <td>0.055868</td>
      <td>0.073622</td>
      <td>-0.050954</td>
      <td>0.073805</td>
      <td>-0.067701</td>
      <td>-0.037118</td>
      <td>-0.016102</td>
      <td>-0.148457</td>
    </tr>
    <tr>
      <th>Hormone Therapy</th>
      <td>0.288164</td>
      <td>-0.002698</td>
      <td>-0.049100</td>
      <td>0.011571</td>
      <td>0.042206</td>
      <td>-0.151132</td>
      <td>0.103637</td>
      <td>-0.110406</td>
      <td>0.352298</td>
      <td>0.374691</td>
      <td>...</td>
      <td>0.028626</td>
      <td>-0.095640</td>
      <td>-0.032737</td>
      <td>0.168272</td>
      <td>0.104215</td>
      <td>-0.062654</td>
      <td>-0.020920</td>
      <td>-0.216933</td>
      <td>0.062860</td>
      <td>0.225784</td>
    </tr>
    <tr>
      <th>Inferred Menopausal State</th>
      <td>-0.739244</td>
      <td>-0.028166</td>
      <td>-0.020323</td>
      <td>-0.062639</td>
      <td>0.010492</td>
      <td>0.339340</td>
      <td>-0.009907</td>
      <td>-0.038635</td>
      <td>-0.254925</td>
      <td>-0.221288</td>
      <td>...</td>
      <td>-0.058357</td>
      <td>0.061628</td>
      <td>0.166180</td>
      <td>-0.029563</td>
      <td>0.075461</td>
      <td>0.017381</td>
      <td>0.056973</td>
      <td>0.130140</td>
      <td>-0.007854</td>
      <td>-0.022096</td>
    </tr>
    <tr>
      <th>Integrative Cluster</th>
      <td>0.166756</td>
      <td>0.059228</td>
      <td>-0.021792</td>
      <td>0.004290</td>
      <td>0.016134</td>
      <td>-0.157695</td>
      <td>-0.043823</td>
      <td>0.036605</td>
      <td>0.238499</td>
      <td>0.285411</td>
      <td>...</td>
      <td>0.022198</td>
      <td>0.018184</td>
      <td>-0.085061</td>
      <td>0.227942</td>
      <td>-0.050791</td>
      <td>0.014799</td>
      <td>0.008063</td>
      <td>-0.154247</td>
      <td>-0.006348</td>
      <td>0.005687</td>
    </tr>
    <tr>
      <th>Primary Tumor Laterality</th>
      <td>-0.037519</td>
      <td>0.017675</td>
      <td>0.006627</td>
      <td>-0.033510</td>
      <td>0.008062</td>
      <td>0.039614</td>
      <td>-0.001805</td>
      <td>0.059525</td>
      <td>-0.002457</td>
      <td>-0.012368</td>
      <td>...</td>
      <td>-0.048998</td>
      <td>-0.077431</td>
      <td>-0.008188</td>
      <td>-0.004369</td>
      <td>-0.004659</td>
      <td>-0.073092</td>
      <td>0.017630</td>
      <td>0.015188</td>
      <td>0.020596</td>
      <td>0.034040</td>
    </tr>
    <tr>
      <th>Lymph nodes examined positive</th>
      <td>-0.006486</td>
      <td>0.150028</td>
      <td>-0.019195</td>
      <td>-0.031451</td>
      <td>-0.024969</td>
      <td>0.282584</td>
      <td>-0.011359</td>
      <td>-0.018728</td>
      <td>-0.121017</td>
      <td>-0.100471</td>
      <td>...</td>
      <td>-0.029702</td>
      <td>-0.241819</td>
      <td>-0.168430</td>
      <td>-0.086743</td>
      <td>0.128751</td>
      <td>-0.239280</td>
      <td>0.239840</td>
      <td>0.039828</td>
      <td>0.263637</td>
      <td>0.420324</td>
    </tr>
    <tr>
      <th>Mutation Count</th>
      <td>0.011358</td>
      <td>0.013295</td>
      <td>-0.030457</td>
      <td>0.006931</td>
      <td>-0.041693</td>
      <td>-0.063467</td>
      <td>-0.164371</td>
      <td>0.231491</td>
      <td>-0.052083</td>
      <td>-0.044131</td>
      <td>...</td>
      <td>-0.006482</td>
      <td>0.040749</td>
      <td>-0.086611</td>
      <td>-0.059877</td>
      <td>-0.091471</td>
      <td>0.027180</td>
      <td>0.030547</td>
      <td>-0.011303</td>
      <td>0.017585</td>
      <td>-0.018893</td>
    </tr>
    <tr>
      <th>Nottingham prognostic index</th>
      <td>-0.088502</td>
      <td>0.120280</td>
      <td>-0.089751</td>
      <td>-0.171747</td>
      <td>-0.107447</td>
      <td>0.426257</td>
      <td>-0.071034</td>
      <td>-0.034382</td>
      <td>-0.332252</td>
      <td>-0.260519</td>
      <td>...</td>
      <td>-0.107794</td>
      <td>-0.240944</td>
      <td>-0.142377</td>
      <td>-0.241414</td>
      <td>0.234916</td>
      <td>-0.217502</td>
      <td>0.230403</td>
      <td>0.095289</td>
      <td>0.274035</td>
      <td>0.546079</td>
    </tr>
    <tr>
      <th>Oncotree Code</th>
      <td>0.062206</td>
      <td>-0.004981</td>
      <td>0.084689</td>
      <td>0.699128</td>
      <td>0.075948</td>
      <td>-0.112020</td>
      <td>0.044668</td>
      <td>-0.011877</td>
      <td>0.122943</td>
      <td>0.161909</td>
      <td>...</td>
      <td>1.000000</td>
      <td>0.032593</td>
      <td>-0.038796</td>
      <td>0.115938</td>
      <td>-0.040695</td>
      <td>0.027649</td>
      <td>0.001994</td>
      <td>-0.119241</td>
      <td>-0.019122</td>
      <td>-0.018243</td>
    </tr>
    <tr>
      <th>Overall Survival (Months)</th>
      <td>-0.145803</td>
      <td>-0.112348</td>
      <td>-0.027626</td>
      <td>0.036518</td>
      <td>0.037511</td>
      <td>-0.162947</td>
      <td>0.026282</td>
      <td>0.090927</td>
      <td>0.095315</td>
      <td>0.124821</td>
      <td>...</td>
      <td>0.032593</td>
      <td>1.000000</td>
      <td>0.381050</td>
      <td>0.147637</td>
      <td>-0.003449</td>
      <td>0.902319</td>
      <td>-0.314960</td>
      <td>-0.033684</td>
      <td>-0.189017</td>
      <td>-0.264401</td>
    </tr>
    <tr>
      <th>Overall Survival Status</th>
      <td>-0.303115</td>
      <td>-0.174123</td>
      <td>0.045530</td>
      <td>-0.014288</td>
      <td>0.008493</td>
      <td>0.035280</td>
      <td>0.070589</td>
      <td>-0.154633</td>
      <td>-0.001551</td>
      <td>-0.028093</td>
      <td>...</td>
      <td>-0.038796</td>
      <td>0.381050</td>
      <td>1.000000</td>
      <td>0.015810</td>
      <td>0.098703</td>
      <td>0.404619</td>
      <td>-0.515191</td>
      <td>0.006840</td>
      <td>-0.163863</td>
      <td>-0.202757</td>
    </tr>
    <tr>
      <th>PR Status</th>
      <td>0.085297</td>
      <td>-0.036952</td>
      <td>-0.040942</td>
      <td>0.084579</td>
      <td>0.028045</td>
      <td>-0.256699</td>
      <td>0.028320</td>
      <td>0.018509</td>
      <td>0.398906</td>
      <td>0.542302</td>
      <td>...</td>
      <td>0.115938</td>
      <td>0.147637</td>
      <td>0.015810</td>
      <td>1.000000</td>
      <td>-0.045184</td>
      <td>0.103342</td>
      <td>-0.050074</td>
      <td>-0.269506</td>
      <td>-0.101831</td>
      <td>-0.110076</td>
    </tr>
    <tr>
      <th>Radio Therapy</th>
      <td>-0.127463</td>
      <td>-0.485885</td>
      <td>-0.046924</td>
      <td>-0.053921</td>
      <td>-0.036856</td>
      <td>0.234951</td>
      <td>0.004469</td>
      <td>-0.203728</td>
      <td>-0.125338</td>
      <td>-0.083772</td>
      <td>...</td>
      <td>-0.040695</td>
      <td>-0.003449</td>
      <td>0.098703</td>
      <td>-0.045184</td>
      <td>1.000000</td>
      <td>0.006831</td>
      <td>0.013598</td>
      <td>0.081204</td>
      <td>0.017942</td>
      <td>0.136210</td>
    </tr>
    <tr>
      <th>Relapse Free Status (Months)</th>
      <td>-0.084559</td>
      <td>-0.109563</td>
      <td>-0.020290</td>
      <td>0.030933</td>
      <td>0.017248</td>
      <td>-0.143892</td>
      <td>0.035655</td>
      <td>0.074819</td>
      <td>0.062689</td>
      <td>0.083115</td>
      <td>...</td>
      <td>0.027649</td>
      <td>0.902319</td>
      <td>0.404619</td>
      <td>0.103342</td>
      <td>0.006831</td>
      <td>1.000000</td>
      <td>-0.523820</td>
      <td>-0.020015</td>
      <td>-0.179703</td>
      <td>-0.238193</td>
    </tr>
    <tr>
      <th>Relapse Free Status</th>
      <td>-0.064534</td>
      <td>0.088921</td>
      <td>-0.032154</td>
      <td>-0.018373</td>
      <td>0.004789</td>
      <td>0.135218</td>
      <td>-0.045770</td>
      <td>0.010319</td>
      <td>-0.061594</td>
      <td>-0.036986</td>
      <td>...</td>
      <td>0.001994</td>
      <td>-0.314960</td>
      <td>-0.515191</td>
      <td>-0.050074</td>
      <td>0.013598</td>
      <td>-0.523820</td>
      <td>1.000000</td>
      <td>0.024834</td>
      <td>0.149127</td>
      <td>0.217107</td>
    </tr>
    <tr>
      <th>3-Gene classifier subtype</th>
      <td>-0.165661</td>
      <td>0.007630</td>
      <td>0.038482</td>
      <td>-0.069153</td>
      <td>0.038176</td>
      <td>0.226495</td>
      <td>-0.068081</td>
      <td>-0.016501</td>
      <td>-0.351662</td>
      <td>-0.471022</td>
      <td>...</td>
      <td>-0.119241</td>
      <td>-0.033684</td>
      <td>0.006840</td>
      <td>-0.269506</td>
      <td>0.081204</td>
      <td>-0.020015</td>
      <td>0.024834</td>
      <td>1.000000</td>
      <td>0.004997</td>
      <td>0.034674</td>
    </tr>
    <tr>
      <th>Tumor Size</th>
      <td>0.045978</td>
      <td>0.241533</td>
      <td>-0.013406</td>
      <td>0.008142</td>
      <td>-0.073892</td>
      <td>0.198218</td>
      <td>-0.046597</td>
      <td>0.015202</td>
      <td>-0.097906</td>
      <td>-0.075291</td>
      <td>...</td>
      <td>-0.019122</td>
      <td>-0.189017</td>
      <td>-0.163863</td>
      <td>-0.101831</td>
      <td>0.017942</td>
      <td>-0.179703</td>
      <td>0.149127</td>
      <td>0.004997</td>
      <td>1.000000</td>
      <td>0.460394</td>
    </tr>
    <tr>
      <th>Tumor Stage</th>
      <td>0.080849</td>
      <td>0.219802</td>
      <td>-0.074396</td>
      <td>-0.101022</td>
      <td>-0.068778</td>
      <td>0.334580</td>
      <td>-0.052015</td>
      <td>-0.014845</td>
      <td>-0.165972</td>
      <td>-0.089640</td>
      <td>...</td>
      <td>-0.018243</td>
      <td>-0.264401</td>
      <td>-0.202757</td>
      <td>-0.110076</td>
      <td>0.136210</td>
      <td>-0.238193</td>
      <td>0.217107</td>
      <td>0.034674</td>
      <td>0.460394</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>31 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="89">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation of the Attributes</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">15</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation of Attributes&#39;</span>, y<span class="op">=</span><span class="fl">1.05</span>, size<span class="op">=</span><span class="dv">25</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(), cmap<span class="op">=</span><span class="st">&#39;plasma&#39;</span>,annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>, cbar<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="89">
<pre><code>&lt;Axes: title={&#39;center&#39;: &#39;Correlation of Attributes&#39;}&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/34126d06331fdd7b7b382479c069406487bc8e66.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<ul>
<li><p><strong>Strong Positive Correlation</strong>: Some numerical
features may exhibit a high positive correlation <strong>(close to
+1)</strong>, meaning that as one variable increases, the other tends to
increase as well. For example, <strong>Overall Survival
(Months)</strong> and the <strong>Relapse Free Status (Months)</strong>
are positively correlated.</p></li>
<li><p><strong>Strong Negative Correlation</strong>: A correlation
<strong>close to -1</strong> indicates a strong inverse relationship,
where an increase in one feature results in a decrease in another. For
instance, <strong>Age at Diagnosis</strong> correlate negatively with
<strong>Inferred Menopausal State</strong>.</p></li>
<li><p><strong>Weak or No Correlation</strong>: If the correlation
coefficient is <strong>close to 0</strong>, it suggests little to no
linear relationship between the features. For example, <strong>HER2
Status</strong> and <strong>Cellularity</strong> are independent of each
other.</p></li>
<li><p><strong>Medical Implications</strong>: Understanding these
correlations is crucial in identifying key factors that influence breast
cancer prognosis and treatment outcomes. Features with strong
correlations can be useful in predictive modeling.</p></li>
</ul>
</div>
<div class="cell markdown">
<p><a id="splitting"></a></p>
<h1
id="step-5--data-splitting"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
5 | Data Splitting</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell code" data-execution_count="90">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Dataset into Features and Target Variable</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.drop(<span class="st">&quot;Overall Survival Status&quot;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&quot;Overall Survival Status&quot;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="91">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Dataset into Training and Testing Sets</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>x_train.shape, x_test.shape, y_train.shape, y_test.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="91">
<pre><code>((1584, 30), (397, 30), (1584,), (397,))</code></pre>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Inferences:</font></h2>
<p>The dataset was split into <strong>features (x)</strong> and
<strong>target variable (y)</strong>, where <strong>"Overall Survival
Status"</strong> was set as the target.</p>
<p>Using <strong>train-test split</strong>, the data was divided into
<strong>80% training</strong> and <strong>20% testing</strong> to ensure
effective model training and evaluation.</p>
</div>
<div class="cell markdown">
<p><a id="lr"></a></p>
<h1
id="step-6--logistic-regression-model-building"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
6 | Logistic Regression Model Building</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:120%; text-align:left">
<p><strong>🔍<span style="font-size:130%; color:red"> Note:
</span></strong> In medical diagnostics, particularly for identifying
illnesses, <strong>high recall (sensitivity) for the positive class
(patients with the condition) is crucial</strong>. A high recall ensures
that nearly all actual positive cases are correctly detected, even if it
leads to some false positives (misclassifying healthy individuals as
having the condition). This trade-off is acceptable because it's far
better to have false alarms than to overlook a patient who genuinely
needs medical attention.</p>
</div>
<div class="cell markdown">
<p><a id="lr_base"></a></p>
<h1
id="step-61--lr-base-model-definition"><b><span style='color:coral'>Step
6.1 |</span><span style='color:tomato'> LR Base Model
Definition</span></b></h1>
</div>
<div class="cell code" data-execution_count="92">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Logistic Regression Model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="92">
<style>#sk-container-id-14 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-14 {
  color: var(--sklearn-color-text);
}

#sk-container-id-14 pre {
  padding: 0;
}

#sk-container-id-14 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-14 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-14 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-14 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-14 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-14 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-14 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-14 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-14 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-14 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-14 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-14 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-14 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-14 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-14 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-14 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-14 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-14 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-14 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-14 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-14 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-14 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-14 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-14 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-14 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-14 div.sk-label label.sk-toggleable__label,
#sk-container-id-14 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-14 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-14 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-14 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-14 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-14 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-14 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-14 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-14 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-14 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-14 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-14 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-14 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-14" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" checked><label for="sk-estimator-id-22" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression()</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="lr_hp"></a></p>
<h1
id="step-62--lr-hyperparameter-tuning"><b><span style='color:coral'>Step
6.2 |</span><span style='color:tomato'> LR Hyperparameter
Tuning</span></b></h1>
</div>
<div class="cell code" data-execution_count="93">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameter grid</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>grid_parameter <span class="op">=</span> {</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;penalty&#39;</span>: [<span class="st">&#39;l1&#39;</span>, <span class="st">&#39;l2&#39;</span>, <span class="st">&#39;elasticnet&#39;</span>, <span class="st">&#39;none&#39;</span>],</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>],  <span class="co"># Regularization strength</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;solver&#39;</span>: [<span class="st">&#39;liblinear&#39;</span>, <span class="st">&#39;lbfgs&#39;</span>, <span class="st">&#39;newton-cg&#39;</span>, <span class="st">&#39;sag&#39;</span>, <span class="st">&#39;saga&#39;</span>],</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_iter&#39;</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>],  <span class="co"># Iterations for convergence</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;tol&#39;</span>: [<span class="fl">1e-4</span>, <span class="fl">1e-3</span>, <span class="fl">1e-2</span>]  <span class="co"># Tolerance for stopping criteria</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Grid Search</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(model, grid_parameter, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train, y_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 900 candidates, totalling 4500 fits
</code></pre>
</div>
<div class="output execute_result" data-execution_count="93">
<style>#sk-container-id-15 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-15 {
  color: var(--sklearn-color-text);
}

#sk-container-id-15 pre {
  padding: 0;
}

#sk-container-id-15 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-15 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-15 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-15 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-15 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-15 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-15 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-15 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-15 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-15 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-15 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-15 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-15 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-15 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-15 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-15 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-15 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-15 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-15 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-15 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-15 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-15 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-15 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-15 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-15 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-15 div.sk-label label.sk-toggleable__label,
#sk-container-id-15 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-15 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-15 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-15 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-15 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-15 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-15 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-15 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-15 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-15 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-15 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-15 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-15 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-15" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=LogisticRegression(), n_jobs=-1,
             param_grid={&#x27;C&#x27;: [0.01, 0.1, 1, 10, 100],
                         &#x27;max_iter&#x27;: [100, 200, 500],
                         &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;, &#x27;none&#x27;],
                         &#x27;solver&#x27;: [&#x27;liblinear&#x27;, &#x27;lbfgs&#x27;, &#x27;newton-cg&#x27;, &#x27;sag&#x27;,
                                    &#x27;saga&#x27;],
                         &#x27;tol&#x27;: [0.0001, 0.001, 0.01]},
             verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=LogisticRegression(), n_jobs=-1,
             param_grid={&#x27;C&#x27;: [0.01, 0.1, 1, 10, 100],
                         &#x27;max_iter&#x27;: [100, 200, 500],
                         &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;, &#x27;none&#x27;],
                         &#x27;solver&#x27;: [&#x27;liblinear&#x27;, &#x27;lbfgs&#x27;, &#x27;newton-cg&#x27;, &#x27;sag&#x27;,
                                    &#x27;saga&#x27;],
                         &#x27;tol&#x27;: [0.0001, 0.001, 0.01]},
             verbose=1)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: LogisticRegression</label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=1, max_iter=500, penalty=&#x27;l1&#x27;, solver=&#x27;liblinear&#x27;)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox" ><label for="sk-estimator-id-25" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=1, max_iter=500, penalty=&#x27;l1&#x27;, solver=&#x27;liblinear&#x27;)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="94">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the best parameters</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>best_parameter <span class="op">=</span> grid_search.best_params_</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> grid_search.best_score_</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, best_parameter)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Score:&quot;</span>, best_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;C&#39;: 1, &#39;max_iter&#39;: 500, &#39;penalty&#39;: &#39;l1&#39;, &#39;solver&#39;: &#39;liblinear&#39;, &#39;tol&#39;: 0.0001}
Best Score: 0.8219602284071398
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="95">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the best parameters</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>lr_model <span class="op">=</span> LogisticRegression(<span class="op">**</span>best_parameter)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>lr_model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="95">
<style>#sk-container-id-16 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-16 {
  color: var(--sklearn-color-text);
}

#sk-container-id-16 pre {
  padding: 0;
}

#sk-container-id-16 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-16 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-16 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-16 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-16 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-16 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-16 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-16 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-16 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-16 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-16 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-16 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-16 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-16 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-16 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-16 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-16 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-16 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-16 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-16 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-16 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-16 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-16 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-16 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-16 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-16 div.sk-label label.sk-toggleable__label,
#sk-container-id-16 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-16 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-16 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-16 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-16 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-16 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-16 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-16 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-16 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-16 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-16 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-16 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-16 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-16" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression(C=1, max_iter=500, penalty=&#x27;l1&#x27;, solver=&#x27;liblinear&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox" checked><label for="sk-estimator-id-26" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression(C=1, max_iter=500, penalty=&#x27;l1&#x27;, solver=&#x27;liblinear&#x27;)</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="lr_eval"></a></p>
<h1 id="step-63--lr-model-evaluation"><b><span style='color:coral'>Step
6.3 |</span><span style='color:tomato'> LR Model
Evaluation</span></b></h1>
</div>
<div class="cell code" data-execution_count="96">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report of the Logistic Regression Model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lr_model.predict(x_test)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>classification <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classification Report :</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Classification Report :

              precision    recall  f1-score   support

         0.0       0.84      0.86      0.85       233
         1.0       0.79      0.77      0.78       164

    accuracy                           0.82       397
   macro avg       0.82      0.81      0.81       397
weighted avg       0.82      0.82      0.82       397

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="97">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix as a heatmap</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>confusion <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, xticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique(),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique())</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Logistic Regression Confusion Matrix&#39;</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/f1a47296568e9a7ef5fe927d0a89d3632cfb0311.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius: 10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Logistic Regression Model:</font></h2>
<p>The <strong>Logistic Regression model</strong> was trained with
<strong>hyperparameter tuning</strong>, which helped optimize its
performance, particularly in achieving a <strong>high recall</strong>,
making it effective for identifying positive cases.</p>
<p>The model’s performance was evaluated using a <strong>classification
report</strong>, which provided key metrics such as <strong>precision,
recall, and F1-score</strong>. A <strong>confusion matrix</strong> was
also used to analyze the distribution of correct and incorrect
predictions, providing a clearer understanding of the model’s
effectiveness.</p>
</div>
<div class="cell markdown">
<p><a id="lr_vis"></a></p>
<h1
id="step-64--auc-roc-curve-visualization"><b><span style='color:coral'>Step
6.4 |</span><span style='color:tomato'> AUC-ROC Curve
Visualization</span></b></h1>
</div>
<div class="cell code" data-execution_count="98">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC Curve and AUC</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>y_pred_prob <span class="op">=</span> lr_model.predict_proba(x_test)[:, <span class="dv">1</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> roc_auc_score(y_test, y_pred_prob)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>fpr, tpr, _ <span class="op">=</span> roc_curve(y_test, y_pred_prob)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, color<span class="op">=</span><span class="st">&#39;darkorange&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f&#39;ROC curve (AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">)&#39;</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], color<span class="op">=</span><span class="st">&#39;navy&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="fl">0.0</span>, <span class="fl">1.05</span>])</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Receiver Operating Characteristic&#39;</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/c76555b932efa8facc707366ac9ff75c3d05151a.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>AUC-ROC Curve Visualization:</font></h2>
<p>The model’s performance was visualized using the <strong>AUC-ROC
curve</strong>, which helps assess its ability to differentiate between
classes. With an <strong>ROC curve (AUC = 0.91)</strong>, the curve
demonstrates the model's strong ability to distinguish between the
classes, though not perfectly. This visualization provides deeper
insights into the model’s effectiveness in medical diagnosis</p>
</div>
<div class="cell markdown">
<p><a id="dt"></a></p>
<h1
id="step-7--decision-tree-model-building"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
7 | Decision Tree Model Building</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<p><a id="dt_base"></a></p>
<h1
id="step-71--dt-base-model-definition"><b><span style='color:coral'>Step
7.1 |</span><span style='color:tomato'> DT Base Model
Definition</span></b></h1>
</div>
<div class="cell code" data-execution_count="99">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Decision Tree model</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="99">
<style>#sk-container-id-17 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-17 {
  color: var(--sklearn-color-text);
}

#sk-container-id-17 pre {
  padding: 0;
}

#sk-container-id-17 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-17 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-17 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-17 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-17 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-17 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-17 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-17 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-17 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-17 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-17 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-17 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-17 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-17 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-17 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-17 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-17 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-17 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-17 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-17 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-17 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-17 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-17 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-17 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-17 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-17 div.sk-label label.sk-toggleable__label,
#sk-container-id-17 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-17 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-17 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-17 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-17 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-17 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-17 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-17 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-17 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-17 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-17 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-17 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-17 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-17" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" checked><label for="sk-estimator-id-27" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;DecisionTreeClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.tree.DecisionTreeClassifier.html">?<span>Documentation for DecisionTreeClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>DecisionTreeClassifier()</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="dt_hp"></a></p>
<h1
id="step-72--dt-hyperparameter-tuning"><b><span style='color:coral'>Step
7.2 |</span><span style='color:tomato'> DT Hyperparameter
Tuning</span></b></h1>
</div>
<div class="cell code" data-execution_count="100">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameter grid</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>grid_parameter <span class="op">=</span> {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;gini&#39;</span>, <span class="st">&#39;entropy&#39;</span>],  <span class="co"># Splitting criteria</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>],  <span class="co"># Maximum depth of the tree</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],  <span class="co"># Minimum number of samples required to split</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]  <span class="co"># Minimum number of samples per leaf</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Grid Search</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(model, grid_parameter, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train, y_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 108 candidates, totalling 540 fits
</code></pre>
</div>
<div class="output execute_result" data-execution_count="100">
<style>#sk-container-id-18 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-18 {
  color: var(--sklearn-color-text);
}

#sk-container-id-18 pre {
  padding: 0;
}

#sk-container-id-18 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-18 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-18 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-18 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-18 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-18 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-18 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-18 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-18 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-18 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-18 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-18 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-18 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-18 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-18 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-18 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-18 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-18 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-18 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-18 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-18 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-18 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-18 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-18 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-18 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-18 div.sk-label label.sk-toggleable__label,
#sk-container-id-18 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-18 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-18 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-18 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-18 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-18 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-18 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-18 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-18 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-18 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-18 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-18 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-18 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-18" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=DecisionTreeClassifier(), n_jobs=-1,
             param_grid={&#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [None, 10, 20, 30, 40, 50],
                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],
                         &#x27;min_samples_split&#x27;: [2, 5, 10]},
             verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox" ><label for="sk-estimator-id-28" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=DecisionTreeClassifier(), n_jobs=-1,
             param_grid={&#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [None, 10, 20, 30, 40, 50],
                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],
                         &#x27;min_samples_split&#x27;: [2, 5, 10]},
             verbose=1)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox" ><label for="sk-estimator-id-29" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: DecisionTreeClassifier</label><div class="sk-toggleable__content fitted"><pre>DecisionTreeClassifier(criterion=&#x27;entropy&#x27;, min_samples_leaf=4,
                       min_samples_split=10)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox" ><label for="sk-estimator-id-30" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;DecisionTreeClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.tree.DecisionTreeClassifier.html">?<span>Documentation for DecisionTreeClassifier</span></a></label><div class="sk-toggleable__content fitted"><pre>DecisionTreeClassifier(criterion=&#x27;entropy&#x27;, min_samples_leaf=4,
                       min_samples_split=10)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="101">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the best parameters</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>best_parameter <span class="op">=</span> grid_search.best_params_</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> grid_search.best_score_</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, best_parameter)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Score:&quot;</span>, best_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: None, &#39;min_samples_leaf&#39;: 4, &#39;min_samples_split&#39;: 10}
Best Score: 0.7821926286786727
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="102">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the best parameters</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>dt_model <span class="op">=</span> DecisionTreeClassifier(<span class="op">**</span>best_parameter)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>dt_model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="102">
<style>#sk-container-id-19 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-19 {
  color: var(--sklearn-color-text);
}

#sk-container-id-19 pre {
  padding: 0;
}

#sk-container-id-19 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-19 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-19 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-19 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-19 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-19 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-19 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-19 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-19 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-19 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-19 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-19 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-19 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-19 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-19 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-19 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-19 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-19 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-19 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-19 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-19 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-19 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-19 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-19 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-19 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-19 div.sk-label label.sk-toggleable__label,
#sk-container-id-19 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-19 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-19 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-19 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-19 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-19 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-19 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-19 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-19 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-19 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-19 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-19 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-19 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-19" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier(criterion=&#x27;entropy&#x27;, min_samples_leaf=4,
                       min_samples_split=10)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox" checked><label for="sk-estimator-id-31" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;DecisionTreeClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.tree.DecisionTreeClassifier.html">?<span>Documentation for DecisionTreeClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>DecisionTreeClassifier(criterion=&#x27;entropy&#x27;, min_samples_leaf=4,
                       min_samples_split=10)</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="dt_eval"></a></p>
<h1 id="step-73--dt-model-evaluation"><b><span style='color:coral'>Step
7.3 |</span><span style='color:tomato'> DT Model
Evaluation</span></b></h1>
</div>
<div class="cell code" data-execution_count="103">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report of the Decision Tree Model</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> dt_model.predict(x_test)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>classification <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classification Report :</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Classification Report :

              precision    recall  f1-score   support

         0.0       0.83      0.86      0.85       233
         1.0       0.79      0.76      0.77       164

    accuracy                           0.82       397
   macro avg       0.81      0.81      0.81       397
weighted avg       0.82      0.82      0.82       397

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="104">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix as a heatmap</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>confusion <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, xticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique(),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique())</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Decision Tree Confusion Matrix&#39;</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/f2bd74b10c701a6cacee13d0ef67b70d23bb3155.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Decision Tree Model:</font></h2>
<p>In addition to Logistic Regression, a <strong>Decision Tree</strong>
model was built to analyze the dataset. This model was trained to
capture complex relationships between features and improve
interpretability. Like the previous model, it was evaluated using a
<strong>classification report</strong> and a <strong>confusion
matrix</strong> to assess its performance.</p>
</div>
<div class="cell markdown">
<p><a id="dt_vis"></a></p>
<h1
id="step-74--dt-model-visualization"><b><span style='color:coral'>Step
7.4 |</span><span style='color:tomato'> DT Model
Visualization</span></b></h1>
</div>
<div class="cell code" data-execution_count="105">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the Decision Tree Model as a PNG Image</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pydotplus</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pydotplus</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y.<span class="bu">map</span>({<span class="dv">0</span>: <span class="st">&quot;Deceased&quot;</span>, <span class="dv">1</span>: <span class="st">&quot;Living&quot;</span>})</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the Decision Tree</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>dot_data <span class="op">=</span> export_graphviz(</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    dt_model,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    out_file<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    feature_names<span class="op">=</span>x.columns,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    class_names<span class="op">=</span>y.unique(),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    filled<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    rounded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    special_characters<span class="op">=</span><span class="va">True</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> pydotplus.graph_from_dot_data(dot_data)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>graph.write_png(<span class="st">&quot;breast_cancer_tree.png&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: pydotplus in c:\bia\lib\site-packages (2.0.2)
Requirement already satisfied: pyparsing&gt;=2.0.1 in c:\bia\lib\site-packages (from pydotplus) (3.2.0)
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>
[notice] A new release of pip is available: 24.3.1 -&gt; 25.0.1
[notice] To update, run: python.exe -m pip install --upgrade pip
</code></pre>
</div>
<div class="output execute_result" data-execution_count="105">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="106">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the decision tree visualization (can be found in the current directory)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(plt.imread(<span class="st">&quot;breast_cancer_tree.png&quot;</span>))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/19b59433cb82411cce2d6653ca0b9cf5bc204289.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Decision Tree Visualization:</font></h2>
<p>The <strong>Decision Tree</strong> was visualized to understand its
decision-making process. Using <strong>Gini Impurity</strong> as the
splitting criterion, the tree effectively classified patients by
identifying the most important features at each split. This
visualization helps interpret the model’s structure and the key factors
influencing predictions.</p>
</div>
<div class="cell markdown">
<p><a id="rf"></a></p>
<h1
id="step-8--random-forest-model-building"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
8 | Random Forest Model Building</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<p><a id="rf_base"></a></p>
<h1
id="step-81--rf-base-model-definition"><b><span style='color:coral'>Step
8.1 |</span><span style='color:tomato'> RF Base Model
Definition</span></b></h1>
</div>
<div class="cell code" data-execution_count="107">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Forest Model with 100 Trees</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="107">
<style>#sk-container-id-20 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-20 {
  color: var(--sklearn-color-text);
}

#sk-container-id-20 pre {
  padding: 0;
}

#sk-container-id-20 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-20 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-20 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-20 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-20 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-20 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-20 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-20 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-20 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-20 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-20 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-20 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-20 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-20 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-20 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-20 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-20 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-20 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-20 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-20 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-20 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-20 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-20 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-20 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-20 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-20 div.sk-label label.sk-toggleable__label,
#sk-container-id-20 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-20 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-20 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-20 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-20 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-20 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-20 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-20 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-20 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-20 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-20 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-20 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-20 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-20" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox" checked><label for="sk-estimator-id-32" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomForestClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier()</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="rf_hp"></a></p>
<h1
id="step-82--rf-hyperparameter-tuning"><b><span style='color:coral'>Step
8.2 |</span><span style='color:tomato'> RF Hyperparameter
Tuning</span></b></h1>
</div>
<div class="cell code" data-execution_count="108">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameter grid</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>grid_parameter <span class="op">=</span> {</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>],  <span class="co"># Number of trees in the forest</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;criterion&#39;</span>: [<span class="st">&#39;gini&#39;</span>, <span class="st">&#39;entropy&#39;</span>],  <span class="co"># Splitting criteria</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>],  <span class="co"># Maximum depth of the trees</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],  <span class="co"># Minimum number of samples required to split a node</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],  <span class="co"># Minimum number of samples per leaf</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;bootstrap&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>]  <span class="co"># Whether to use bootstrap sampling</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Grid Search</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(model, grid_parameter, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, verbose<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train, y_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 864 candidates, totalling 4320 fits
</code></pre>
</div>
<div class="output execute_result" data-execution_count="108">
<style>#sk-container-id-21 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-21 {
  color: var(--sklearn-color-text);
}

#sk-container-id-21 pre {
  padding: 0;
}

#sk-container-id-21 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-21 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-21 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-21 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-21 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-21 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-21 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-21 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-21 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-21 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-21 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-21 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-21 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-21 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-21 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-21 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-21 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-21 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-21 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-21 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-21 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-21 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-21 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-21 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-21 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-21 div.sk-label label.sk-toggleable__label,
#sk-container-id-21 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-21 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-21 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-21 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-21 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-21 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-21 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-21 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-21 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-21 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-21 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-21 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-21 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-21" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=RandomForestClassifier(), n_jobs=-1,
             param_grid={&#x27;bootstrap&#x27;: [True, False],
                         &#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [None, 10, 20, 30, 40, 50],
                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],
                         &#x27;min_samples_split&#x27;: [2, 5, 10],
                         &#x27;n_estimators&#x27;: [50, 100, 200, 300]},
             verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox" ><label for="sk-estimator-id-33" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=RandomForestClassifier(), n_jobs=-1,
             param_grid={&#x27;bootstrap&#x27;: [True, False],
                         &#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [None, 10, 20, 30, 40, 50],
                         &#x27;min_samples_leaf&#x27;: [1, 2, 4],
                         &#x27;min_samples_split&#x27;: [2, 5, 10],
                         &#x27;n_estimators&#x27;: [50, 100, 200, 300]},
             verbose=1)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox" ><label for="sk-estimator-id-34" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: RandomForestClassifier</label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(bootstrap=False, criterion=&#x27;entropy&#x27;, max_depth=10,
                       min_samples_leaf=2, n_estimators=50)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox" ><label for="sk-estimator-id-35" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;RandomForestClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(bootstrap=False, criterion=&#x27;entropy&#x27;, max_depth=10,
                       min_samples_leaf=2, n_estimators=50)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="109">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the best parameters</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>best_parameter <span class="op">=</span> grid_search.best_params_</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> grid_search.best_score_</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, best_parameter)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Score:&quot;</span>, best_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;bootstrap&#39;: False, &#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
Best Score: 0.8295471788523738
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="110">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the best parameters</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(<span class="op">**</span>best_parameter)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>rf_model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="110">
<style>#sk-container-id-22 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-22 {
  color: var(--sklearn-color-text);
}

#sk-container-id-22 pre {
  padding: 0;
}

#sk-container-id-22 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-22 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-22 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-22 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-22 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-22 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-22 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-22 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-22 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-22 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-22 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-22 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-22 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-22 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-22 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-22 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-22 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-22 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-22 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-22 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-22 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-22 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-22 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-22 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-22 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-22 div.sk-label label.sk-toggleable__label,
#sk-container-id-22 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-22 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-22 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-22 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-22 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-22 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-22 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-22 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-22 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-22 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-22 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-22 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-22 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-22" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(bootstrap=False, criterion=&#x27;entropy&#x27;, max_depth=10,
                       min_samples_leaf=2, n_estimators=50)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox" checked><label for="sk-estimator-id-36" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomForestClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(bootstrap=False, criterion=&#x27;entropy&#x27;, max_depth=10,
                       min_samples_leaf=2, n_estimators=50)</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="rf_eval"></a></p>
<h1 id="step-83--rf-model-evaluation"><b><span style='color:coral'>Step
8.3 |</span><span style='color:tomato'> RF Model
Evaluation</span></b></h1>
</div>
<div class="cell code" data-execution_count="111">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report of the Random Forest Model</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> rf_model.predict(x_test)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>classification <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classification Report :</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Classification Report :

              precision    recall  f1-score   support

         0.0       0.85      0.85      0.85       233
         1.0       0.79      0.78      0.79       164

    accuracy                           0.82       397
   macro avg       0.82      0.82      0.82       397
weighted avg       0.82      0.82      0.82       397

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="112">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix as a heatmap</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>confusion <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, xticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique(),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique())</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Random Forest Confusion Matrix&#39;</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/a53edc73b98903eac4d4ad80e720d99ef72f82bb.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Random Forest Model:</font></h2>
<p>The <strong>Random Forest model achieved strong classification
performance</strong>, making it reliable for predicting survival
outcomes. Its ability to handle complex relationships and <strong>reduce
overfitting</strong> contributes to its robustness. However, to ensure
the model's generalizability, further validation using external datasets
is recommended.</p>
</div>
<div class="cell markdown">
<p><a id="svm"></a></p>
<h1
id="step-9--support-vector-machine-svm-model-building"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
9 | Support Vector Machine (SVM) Model Building</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<p><a id="svm_base"></a></p>
<h1
id="step-91--svm-base-model-definition"><b><span style='color:coral'>Step
9.1 |</span><span style='color:tomato'> SVM Base Model
Definition</span></b></h1>
</div>
<div class="cell code" data-execution_count="113">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Support Vector Machine Model</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SVC()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="113">
<style>#sk-container-id-23 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-23 {
  color: var(--sklearn-color-text);
}

#sk-container-id-23 pre {
  padding: 0;
}

#sk-container-id-23 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-23 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-23 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-23 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-23 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-23 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-23 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-23 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-23 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-23 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-23 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-23 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-23 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-23 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-23 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-23 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-23 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-23 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-23 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-23 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-23 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-23 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-23 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-23 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-23 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-23 div.sk-label label.sk-toggleable__label,
#sk-container-id-23 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-23 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-23 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-23 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-23 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-23 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-23 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-23 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-23 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-23 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-23 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-23 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-23 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-23" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-37" type="checkbox" checked><label for="sk-estimator-id-37" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;SVC<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVC.html">?<span>Documentation for SVC</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>SVC()</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="svm_hp"></a></p>
<h1
id="step-92--svm-hyperparameter-tuning"><b><span style='color:coral'>Step
9.2 |</span><span style='color:tomato'> SVM Hyperparameter
Tuning</span></b></h1>
</div>
<div class="cell code" data-execution_count="114">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hyperparameter grid</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>grid_parameter <span class="op">=</span> {</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],  <span class="co"># Reduced range of regularization parameter</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>],  <span class="co"># Keep only the most efficient kernels</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;gamma&#39;</span>: [<span class="st">&#39;scale&#39;</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>],  <span class="co"># Reduce gamma choices</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Grid Search</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(model, grid_parameter, cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="114">
<style>#sk-container-id-24 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-24 {
  color: var(--sklearn-color-text);
}

#sk-container-id-24 pre {
  padding: 0;
}

#sk-container-id-24 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-24 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-24 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-24 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-24 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-24 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-24 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-24 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-24 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-24 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-24 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-24 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-24 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-24 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-24 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-24 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-24 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-24 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-24 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-24 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-24 div.sk-label label.sk-toggleable__label,
#sk-container-id-24 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-24 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-24 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-24 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-24 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-24 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-24 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-24 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-24 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-24 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-24 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-24" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=SVC(), n_jobs=-1,
             param_grid={&#x27;C&#x27;: [0.1, 1, 10], &#x27;gamma&#x27;: [&#x27;scale&#x27;, 0.01, 0.1],
                         &#x27;kernel&#x27;: [&#x27;linear&#x27;, &#x27;rbf&#x27;]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-38" type="checkbox" ><label for="sk-estimator-id-38" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=SVC(), n_jobs=-1,
             param_grid={&#x27;C&#x27;: [0.1, 1, 10], &#x27;gamma&#x27;: [&#x27;scale&#x27;, 0.01, 0.1],
                         &#x27;kernel&#x27;: [&#x27;linear&#x27;, &#x27;rbf&#x27;]})</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-39" type="checkbox" ><label for="sk-estimator-id-39" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: SVC</label><div class="sk-toggleable__content fitted"><pre>SVC(C=1, kernel=&#x27;linear&#x27;)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-40" type="checkbox" ><label for="sk-estimator-id-40" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;SVC<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVC.html">?<span>Documentation for SVC</span></a></label><div class="sk-toggleable__content fitted"><pre>SVC(C=1, kernel=&#x27;linear&#x27;)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="115">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the best parameters</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>best_parameter <span class="op">=</span> grid_search.best_params_</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>best_score <span class="op">=</span> grid_search.best_score_</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, best_parameter)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Score:&quot;</span>, best_score)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;C&#39;: 1, &#39;gamma&#39;: &#39;scale&#39;, &#39;kernel&#39;: &#39;linear&#39;}
Best Score: 0.8194405622329592
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="116">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the best parameters</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>svm_model <span class="op">=</span> SVC(<span class="op">**</span>best_parameter)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>svm_model.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="116">
<style>#sk-container-id-25 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-25 {
  color: var(--sklearn-color-text);
}

#sk-container-id-25 pre {
  padding: 0;
}

#sk-container-id-25 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-25 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-25 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-25 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-25 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-25 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-25 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-25 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-25 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-25 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-25 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-25 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-25 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-25 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-25 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-25 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-25 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-25 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-25 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-25 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-25 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-25 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-25 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-25 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-25 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-25 div.sk-label label.sk-toggleable__label,
#sk-container-id-25 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-25 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-25 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-25 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-25 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-25 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-25 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-25 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-25 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-25 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-25 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-25 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-25 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-25" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC(C=1, kernel=&#x27;linear&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-41" type="checkbox" checked><label for="sk-estimator-id-41" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;SVC<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVC.html">?<span>Documentation for SVC</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>SVC(C=1, kernel=&#x27;linear&#x27;)</pre></div> </div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><a id="svm_eval"></a></p>
<h1 id="step-93--svm-model-evaluation"><b><span style='color:coral'>Step
9.3 |</span><span style='color:tomato'> SVM Model
Evaluation</span></b></h1>
</div>
<div class="cell code" data-execution_count="117">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report of the Support Vector Machine Model</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> svm_model.predict(x_test)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>classification <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classification Report :&quot;</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Classification Report :
              precision    recall  f1-score   support

         0.0       0.85      0.85      0.85       233
         1.0       0.79      0.79      0.79       164

    accuracy                           0.83       397
   macro avg       0.82      0.82      0.82       397
weighted avg       0.83      0.83      0.83       397

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="118">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix as a heatmap</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>confusion <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, xticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique(),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>            yticklabels<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>].unique())</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Support Vector Confusion Matrix&#39;</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/e22ffa304814181798449b11c4bda6afe323c556.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color: rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>Support Vector Machine (SVM) Model:</font></h2>
<p>A <strong>Support Vector Machine (SVM)</strong> model was built to
classify the data effectively. SVM helps find the optimal decision
boundary to separate classes, making it a powerful algorithm for
classification tasks. The model was evaluated using a
<strong>classification report</strong> and a <strong>confusion
matrix</strong> to assess its precision, recall, and overall
performance.</p>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red>✅ Inference:</font></h2>
<p>In this project on <strong>Breast Cancer Survival
Prediction</strong>, the <strong>SVM model</strong> emerged as the most
effective for predicting patient survival. The focus on <strong>recall
for Living patients (class 1)</strong> was crucial, as the primary
objective in a medical context is to ensure that all <strong>surviving
patients</strong> are accurately identified to provide them with the
necessary care and treatment.</p>
<p>While <strong>false positives</strong> (deceased patients
misclassified as living) are important to minimize, <strong>false
negatives</strong> (living patients misclassified as deceased) in cancer
survival prediction can have severe consequences, such as
<strong>denying life-saving treatments</strong>. Thus, high recall for
class 1 ensures that <strong>no living patients are overlooked</strong>
and receive the appropriate medical intervention.</p>
<p>The <strong>SVM model</strong> was chosen due to its ability to
establish an <strong>optimal decision boundary</strong>, which is
crucial for distinguishing between <strong>living</strong> and
<strong>deceased</strong> patients with minimal misclassification. Its
performance in terms of recall for <strong>Living patients</strong> at
<strong>0.79</strong> and <strong>Deceased patients</strong> at
<strong>0.85</strong> shows that it effectively balances identifying
patients in both classes, making it the most reliable model for this
application.</p>
<p>For a <strong>Breast Cancer Survival Prediction</strong> project,
where patient lives are at stake, <strong>SVM</strong> is the ideal
model due to its <strong>strong recall performance for class 1
(Living)</strong>. By ensuring accurate predictions for
<strong>surviving patients</strong>, we enhance the likelihood that all
those in need of care will receive the necessary treatment, thereby
improving overall patient outcomes and safety.</p>
</div>
<div class="cell markdown">
<p><a id="interpretation"></a></p>
<h1
id="step-10--model-interpretation-and-visualization"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
10 | Model Interpretation and Visualization</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<p><a id="kmf"></a></p>
<h1
id="step-101--kaplan-meier-survival-curves"><b><span style='color:coral'>Step
10.1 |</span><span style='color:tomato'> Kaplan-Meier survival
curves</span></b></h1>
</div>
<div class="cell code" data-execution_count="119">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kaplan-Meier Survival Curve</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>kmf <span class="op">=</span> KaplanMeierFitter()</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>kmf.fit(durations<span class="op">=</span>df[<span class="st">&quot;Overall Survival (Months)&quot;</span>], event_observed<span class="op">=</span>df[<span class="st">&quot;Overall Survival Status&quot;</span>])</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>kmf.plot_survival_function()</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Kaplan-Meier Survival Curve&quot;</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Time in Months&quot;</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Survival Probability&quot;</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/878cc68594be6edef3f130572e57990465a5c1b5.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 10px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red> Kaplan-Meier Survival Curve - Inference:</font></h2>
<p>The <strong>Kaplan-Meier Survival Curve</strong> was plotted to
analyze patient survival probabilities over time. The curve provides key
insights into how survival rates change, helping understand the
progression of breast cancer in the dataset.</p>
<ul>
<li>The curve shows a gradual decline, indicating that survival
probability decreases over time.</li>
<li>Steeper drops suggest periods where more patients experience adverse
outcomes, while flatter regions indicate stable survival rates.</li>
<li>If survival curves were compared for different groups (e.g., tumor
stages, treatment types), differences in survival patterns could
highlight factors influencing patient outcomes.</li>
</ul>
<p>This analysis is valuable for medical decision-making, as it helps
estimate survival probabilities and assess the effectiveness of
treatments.</p>
</div>
<div class="cell markdown">
<p><a id="cphm"></a></p>
<h1
id="step-102--cox-proportional-hazards-models"><b><span style='color:coral'>Step
10.2 |</span><span style='color:tomato'> Cox Proportional Hazards
Models</span></b></h1>
</div>
<div class="cell code" data-execution_count="120">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox Proportional Hazards Model</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>cph <span class="op">=</span> CoxPHFitter()</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>cph.fit(df, duration_col<span class="op">=</span><span class="st">&#39;Overall Survival (Months)&#39;</span>, event_col<span class="op">=</span><span class="st">&#39;Overall Survival Status&#39;</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>cph.print_summary()</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>cph.plot()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Cox Proportional Hazards Model&quot;</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>model</th>
      <td>lifelines.CoxPHFitter</td>
    </tr>
    <tr>
      <th>duration col</th>
      <td>'Overall Survival (Months)'</td>
    </tr>
    <tr>
      <th>event col</th>
      <td>'Overall Survival Status'</td>
    </tr>
    <tr>
      <th>baseline estimation</th>
      <td>breslow</td>
    </tr>
    <tr>
      <th>number of observations</th>
      <td>1981</td>
    </tr>
    <tr>
      <th>number of events observed</th>
      <td>837</td>
    </tr>
    <tr>
      <th>partial log-likelihood</th>
      <td>-4008.07</td>
    </tr>
    <tr>
      <th>time fit was run</th>
      <td>2025-02-18 08:43:47 UTC</td>
    </tr>
  </tbody>
</table>
</div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th style="min-width: 12px;"></th>
      <th style="min-width: 12px;">coef</th>
      <th style="min-width: 12px;">exp(coef)</th>
      <th style="min-width: 12px;">se(coef)</th>
      <th style="min-width: 12px;">coef lower 95%</th>
      <th style="min-width: 12px;">coef upper 95%</th>
      <th style="min-width: 12px;">exp(coef) lower 95%</th>
      <th style="min-width: 12px;">exp(coef) upper 95%</th>
      <th style="min-width: 12px;">cmp to</th>
      <th style="min-width: 12px;">z</th>
      <th style="min-width: 12px;">p</th>
      <th style="min-width: 12px;">-log2(p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age at Diagnosis</th>
      <td>-0.03</td>
      <td>0.97</td>
      <td>0.00</td>
      <td>-0.04</td>
      <td>-0.02</td>
      <td>0.96</td>
      <td>0.98</td>
      <td>0.00</td>
      <td>-5.58</td>
      <td>&lt;0.005</td>
      <td>25.32</td>
    </tr>
    <tr>
      <th>Type of Breast Surgery</th>
      <td>-0.24</td>
      <td>0.79</td>
      <td>0.08</td>
      <td>-0.40</td>
      <td>-0.08</td>
      <td>0.67</td>
      <td>0.93</td>
      <td>0.00</td>
      <td>-2.89</td>
      <td>&lt;0.005</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>Cancer Type</th>
      <td>0.35</td>
      <td>1.42</td>
      <td>0.73</td>
      <td>-1.08</td>
      <td>1.78</td>
      <td>0.34</td>
      <td>5.94</td>
      <td>0.00</td>
      <td>0.48</td>
      <td>0.63</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>Cancer Type Detailed</th>
      <td>-0.05</td>
      <td>0.95</td>
      <td>0.06</td>
      <td>-0.16</td>
      <td>0.06</td>
      <td>0.85</td>
      <td>1.07</td>
      <td>0.00</td>
      <td>-0.86</td>
      <td>0.39</td>
      <td>1.35</td>
    </tr>
    <tr>
      <th>Cellularity</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.04</td>
      <td>-0.09</td>
      <td>0.06</td>
      <td>0.92</td>
      <td>1.06</td>
      <td>0.00</td>
      <td>-0.41</td>
      <td>0.68</td>
      <td>0.55</td>
    </tr>
    <tr>
      <th>Chemotherapy</th>
      <td>0.09</td>
      <td>1.10</td>
      <td>0.12</td>
      <td>-0.15</td>
      <td>0.33</td>
      <td>0.86</td>
      <td>1.40</td>
      <td>0.00</td>
      <td>0.77</td>
      <td>0.44</td>
      <td>1.18</td>
    </tr>
    <tr>
      <th>Pam50 + Claudin-low subtype</th>
      <td>0.03</td>
      <td>1.03</td>
      <td>0.02</td>
      <td>-0.01</td>
      <td>0.07</td>
      <td>0.99</td>
      <td>1.07</td>
      <td>0.00</td>
      <td>1.39</td>
      <td>0.16</td>
      <td>2.61</td>
    </tr>
    <tr>
      <th>Cohort</th>
      <td>-0.18</td>
      <td>0.84</td>
      <td>0.04</td>
      <td>-0.25</td>
      <td>-0.11</td>
      <td>0.78</td>
      <td>0.90</td>
      <td>0.00</td>
      <td>-5.03</td>
      <td>&lt;0.005</td>
      <td>20.96</td>
    </tr>
    <tr>
      <th>ER status measured by IHC</th>
      <td>-0.03</td>
      <td>0.97</td>
      <td>0.13</td>
      <td>-0.28</td>
      <td>0.22</td>
      <td>0.75</td>
      <td>1.25</td>
      <td>0.00</td>
      <td>-0.24</td>
      <td>0.81</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>ER Status</th>
      <td>-0.16</td>
      <td>0.86</td>
      <td>0.15</td>
      <td>-0.44</td>
      <td>0.13</td>
      <td>0.64</td>
      <td>1.14</td>
      <td>0.00</td>
      <td>-1.06</td>
      <td>0.29</td>
      <td>1.80</td>
    </tr>
    <tr>
      <th>Neoplasm Histologic Grade</th>
      <td>-0.18</td>
      <td>0.84</td>
      <td>0.10</td>
      <td>-0.38</td>
      <td>0.02</td>
      <td>0.69</td>
      <td>1.02</td>
      <td>0.00</td>
      <td>-1.75</td>
      <td>0.08</td>
      <td>3.64</td>
    </tr>
    <tr>
      <th>HER2 status measured by SNP6</th>
      <td>-0.09</td>
      <td>0.92</td>
      <td>0.06</td>
      <td>-0.19</td>
      <td>0.02</td>
      <td>0.82</td>
      <td>1.02</td>
      <td>0.00</td>
      <td>-1.55</td>
      <td>0.12</td>
      <td>3.04</td>
    </tr>
    <tr>
      <th>HER2 Status</th>
      <td>0.06</td>
      <td>1.06</td>
      <td>0.15</td>
      <td>-0.24</td>
      <td>0.36</td>
      <td>0.78</td>
      <td>1.44</td>
      <td>0.00</td>
      <td>0.39</td>
      <td>0.70</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>Tumor Other Histologic Subtype</th>
      <td>0.05</td>
      <td>1.05</td>
      <td>0.03</td>
      <td>-0.01</td>
      <td>0.10</td>
      <td>0.99</td>
      <td>1.10</td>
      <td>0.00</td>
      <td>1.76</td>
      <td>0.08</td>
      <td>3.68</td>
    </tr>
    <tr>
      <th>Hormone Therapy</th>
      <td>0.18</td>
      <td>1.20</td>
      <td>0.09</td>
      <td>0.00</td>
      <td>0.35</td>
      <td>1.00</td>
      <td>1.42</td>
      <td>0.00</td>
      <td>2.00</td>
      <td>0.05</td>
      <td>4.46</td>
    </tr>
    <tr>
      <th>Inferred Menopausal State</th>
      <td>-0.24</td>
      <td>0.78</td>
      <td>0.12</td>
      <td>-0.48</td>
      <td>-0.01</td>
      <td>0.62</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-2.02</td>
      <td>0.04</td>
      <td>4.53</td>
    </tr>
    <tr>
      <th>Integrative Cluster</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>-0.03</td>
      <td>0.02</td>
      <td>0.97</td>
      <td>1.02</td>
      <td>0.00</td>
      <td>-0.23</td>
      <td>0.82</td>
      <td>0.29</td>
    </tr>
    <tr>
      <th>Primary Tumor Laterality</th>
      <td>0.02</td>
      <td>1.02</td>
      <td>0.06</td>
      <td>-0.11</td>
      <td>0.14</td>
      <td>0.90</td>
      <td>1.15</td>
      <td>0.00</td>
      <td>0.27</td>
      <td>0.78</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>Lymph nodes examined positive</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.02</td>
      <td>-0.04</td>
      <td>0.02</td>
      <td>0.96</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>-0.55</td>
      <td>0.58</td>
      <td>0.78</td>
    </tr>
    <tr>
      <th>Mutation Count</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.01</td>
      <td>-0.01</td>
      <td>0.03</td>
      <td>0.99</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>0.66</td>
      <td>0.51</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>Nottingham prognostic index</th>
      <td>0.16</td>
      <td>1.17</td>
      <td>0.08</td>
      <td>0.01</td>
      <td>0.31</td>
      <td>1.01</td>
      <td>1.36</td>
      <td>0.00</td>
      <td>2.07</td>
      <td>0.04</td>
      <td>4.71</td>
    </tr>
    <tr>
      <th>Oncotree Code</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.04</td>
      <td>-0.09</td>
      <td>0.06</td>
      <td>0.92</td>
      <td>1.07</td>
      <td>0.00</td>
      <td>-0.30</td>
      <td>0.76</td>
      <td>0.39</td>
    </tr>
    <tr>
      <th>PR Status</th>
      <td>0.13</td>
      <td>1.14</td>
      <td>0.09</td>
      <td>-0.04</td>
      <td>0.31</td>
      <td>0.96</td>
      <td>1.37</td>
      <td>0.00</td>
      <td>1.48</td>
      <td>0.14</td>
      <td>2.85</td>
    </tr>
    <tr>
      <th>Radio Therapy</th>
      <td>0.07</td>
      <td>1.08</td>
      <td>0.09</td>
      <td>-0.11</td>
      <td>0.26</td>
      <td>0.90</td>
      <td>1.30</td>
      <td>0.00</td>
      <td>0.79</td>
      <td>0.43</td>
      <td>1.23</td>
    </tr>
    <tr>
      <th>Relapse Free Status (Months)</th>
      <td>-0.07</td>
      <td>0.93</td>
      <td>0.00</td>
      <td>-0.07</td>
      <td>-0.06</td>
      <td>0.93</td>
      <td>0.94</td>
      <td>0.00</td>
      <td>-28.56</td>
      <td>&lt;0.005</td>
      <td>593.47</td>
    </tr>
    <tr>
      <th>Relapse Free Status</th>
      <td>-12.77</td>
      <td>0.00</td>
      <td>0.52</td>
      <td>-13.80</td>
      <td>-11.75</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-24.46</td>
      <td>&lt;0.005</td>
      <td>436.48</td>
    </tr>
    <tr>
      <th>3-Gene classifier subtype</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.03</td>
      <td>-0.06</td>
      <td>0.07</td>
      <td>0.94</td>
      <td>1.08</td>
      <td>0.00</td>
      <td>0.13</td>
      <td>0.90</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>Tumor Size</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.01</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.63</td>
      <td>0.53</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>Tumor Stage</th>
      <td>-0.12</td>
      <td>0.89</td>
      <td>0.09</td>
      <td>-0.31</td>
      <td>0.07</td>
      <td>0.74</td>
      <td>1.07</td>
      <td>0.00</td>
      <td>-1.27</td>
      <td>0.20</td>
      <td>2.29</td>
    </tr>
  </tbody>
</table><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>Concordance</th>
      <td>0.94</td>
    </tr>
    <tr>
      <th>Partial AIC</th>
      <td>8074.15</td>
    </tr>
    <tr>
      <th>log-likelihood ratio test</th>
      <td>2387.28 on 29 df</td>
    </tr>
    <tr>
      <th>-log2(p) of ll-ratio test</th>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output display_data">
<p><img
src="vertopal_77c4ca103b10450ca7ad5126b251ac81/1e9de9b7d6064a5393c4b950d3c9ca2d3886b466.png" /></p>
</div>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red> Kaplan-Meier Survival Curve - Inference:</font></h2>
<p>The <strong>Cox Proportional Hazards Model</strong> was used to
analyze the impact of different variables on patient survival time. This
model estimates the hazard (risk of an event occurring) while
considering multiple factors without requiring a specific survival
distribution.</p>
<ul>
<li>Significant variables in the model indicate which factors strongly
influence survival time. For example, tumor stage, age at diagnosis, and
specific genetic markers may contribute to higher or lower risk.</li>
<li><strong>Hazard ratios (HR)</strong> provide insight into risk
levels—values <strong>greater than 1</strong> indicate <strong>increased
risk</strong>, while values <strong>less than 1</strong> suggest a
<strong>protective effect</strong>.</li>
<li>The model helps in identifying high-risk patient groups, aiding in
personalized treatment strategies.</li>
</ul>
<p>By combining insights from the <strong>Kaplan-Meier Survival
Curve</strong> and the <strong>Cox Model</strong>, we can better
understand patient survival patterns and the key factors affecting
longevity.</p>
</div>
<div class="cell markdown">
<p><a id="conclusion"></a></p>
<h1
id="step-11--conclusion"><p style="background-color:chocolate; font-family:calibri; color:white; font-size:150%; text-align:center; border-radius:50px 50px;">Step
11 | Conclusion</p></h1>
<p>⬆️ <a href="#contents_tabel">Table of Contents</a></p>
</div>
<div class="cell markdown">
<div style="border-radius:10px; padding: 15px; background-color:rgb(250, 240, 200); font-size:115%; text-align:left">
<h2 align="left"><font color=red> Overall Conclusion:</font></h2>
<p>This project aimed to <strong>analyze breast cancer patient
survival</strong> using a combination of <strong>machine learning
models</strong> and <strong>statistical methods</strong>, providing a
comprehensive approach to predict patient outcomes. The process involved
key steps such as <strong>data preprocessing, feature selection,
handling missing values,</strong> and <strong>model training</strong> to
predict survival probabilities and identify influential factors
affecting patient survival.</p>
<ul>
<li><p><strong>Logistic Regression</strong> achieved a <strong>good
recall</strong> for class 1 (living patients), proving its effectiveness
in identifying survivors.</p></li>
<li><p><strong>Decision Tree</strong> and <strong>Random Forest</strong>
provided interpretable results, with <strong>Random Forest</strong>
reducing overfitting by leveraging <strong>ensemble learning</strong>
techniques, which enhanced model robustness.</p></li>
<li><p><strong>Support Vector Machine (SVM)</strong> was highly
effective in <strong>finding optimal decision boundaries</strong> for
classifying patients as either living or deceased, ensuring precise
classification</p></li>
<li><p><strong>Kaplan-Meier Survival Curve</strong> was used to
visualize survival probabilities over time, offering valuable insights
into <strong>survival trends.</strong></p></li>
<li><p><strong>Cox Proportional Hazards Model</strong> helped identify
significant factors that affect <strong>patient survival</strong>,
contributing to better <strong>risk assessment</strong> and supporting
<strong>personalized treatment planning.</strong></p></li>
</ul>
<p>The importance of <strong>high recall for class 1</strong> was
highlighted, ensuring that <strong>living patients</strong> are
correctly identified, minimizing <strong>false negatives</strong> in the
medical diagnosis process. This is especially important in breast cancer
survival prediction, where missing a survivor could result in missed
opportunities for life-saving treatments.</p>
<p>In conclusion, the models developed in this project can significantly
aid in <strong>early detection, risk assessment,</strong> and
<strong>treatment strategy decision-making</strong> for breast cancer
patients. By combining <strong>predictive modeling</strong> with
<strong>survival analysis</strong>, this analysis offers a
<strong>data-driven approach</strong> to understanding breast cancer
prognosis, ultimately contributing to improved <strong>patient
care</strong> and <strong>medical research</strong>.</p>
</div>
</body>
</html>
